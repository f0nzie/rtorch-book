<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Lessons Learned | A Minimal rTorch Tutorial</title>
  <meta name="description" content="This is a minimal tutorial of using the rTorch package to have fun while doing machine learning. This book was produced with bookdown." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Lessons Learned | A Minimal rTorch Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal tutorial of using the rTorch package to have fun while doing machine learning. This book was produced with bookdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Lessons Learned | A Minimal rTorch Tutorial" />
  
  <meta name="twitter:description" content="This is a minimal tutorial of using the rTorch package to have fun while doing machine learning. This book was produced with bookdown." />
  

<meta name="author" content="Alfonso R. Reyes" />


<meta name="date" content="2019-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="tensors.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal rTorch Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>0.1</b> Installation</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#python-anaconda"><i class="fa fa-check"></i><b>0.2</b> Python Anaconda</a><ul>
<li class="chapter" data-level="0.2.1" data-path="index.html"><a href="index.html#example"><i class="fa fa-check"></i><b>0.2.1</b> Example</a></li>
<li class="chapter" data-level="0.2.2" data-path="index.html"><a href="index.html#automatic-installation"><i class="fa fa-check"></i><b>0.2.2</b> Automatic installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>1.1</b> Motivation</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#how-do-we-start-using-rtorch"><i class="fa fa-check"></i><b>1.2</b> How do we start using <code>rTorch</code></a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#what-can-you-do-with-rtorch"><i class="fa fa-check"></i><b>1.3</b> What can you do with <code>rTorch</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lessons-learned.html"><a href="lessons-learned.html"><i class="fa fa-check"></i><b>2</b> Lessons Learned</a><ul>
<li class="chapter" data-level="2.1" data-path="lessons-learned.html"><a href="lessons-learned.html#enumeration"><i class="fa fa-check"></i><b>2.1</b> Enumeration</a></li>
<li class="chapter" data-level="2.2" data-path="lessons-learned.html"><a href="lessons-learned.html#how-to-iterate-a-generator"><i class="fa fa-check"></i><b>2.2</b> How to iterate a generator</a><ul>
<li class="chapter" data-level="2.2.1" data-path="lessons-learned.html"><a href="lessons-learned.html#using-enumerate-and-iterate"><i class="fa fa-check"></i><b>2.2.1</b> Using <code>enumerate</code> and <code>iterate</code></a></li>
<li class="chapter" data-level="2.2.2" data-path="lessons-learned.html"><a href="lessons-learned.html#using-a-for-loop"><i class="fa fa-check"></i><b>2.2.2</b> Using a <code>for-loop</code></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="lessons-learned.html"><a href="lessons-learned.html#zero-gradient"><i class="fa fa-check"></i><b>2.3</b> Zero gradient</a></li>
<li class="chapter" data-level="2.4" data-path="lessons-learned.html"><a href="lessons-learned.html#transform-a-tensor"><i class="fa fa-check"></i><b>2.4</b> Transform a tensor</a></li>
<li class="chapter" data-level="2.5" data-path="lessons-learned.html"><a href="lessons-learned.html#build-a-model-class"><i class="fa fa-check"></i><b>2.5</b> Build a model class</a><ul>
<li class="chapter" data-level="2.5.1" data-path="lessons-learned.html"><a href="lessons-learned.html#examples"><i class="fa fa-check"></i><b>2.5.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="lessons-learned.html"><a href="lessons-learned.html#convert-a-tensor-to-numpy-object"><i class="fa fa-check"></i><b>2.6</b> Convert a tensor to <code>numpy</code> object</a></li>
<li class="chapter" data-level="2.7" data-path="lessons-learned.html"><a href="lessons-learned.html#convert-a-numpy-object-to-an-r-object"><i class="fa fa-check"></i><b>2.7</b> Convert a <code>numpy</code> object to an <code>R</code> object</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tensors.html"><a href="tensors.html"><i class="fa fa-check"></i><b>3</b> Tensors</a><ul>
<li class="chapter" data-level="3.1" data-path="tensors.html"><a href="tensors.html#arithmetic-of-tensors"><i class="fa fa-check"></i><b>3.1</b> Arithmetic of tensors</a></li>
<li class="chapter" data-level="3.2" data-path="tensors.html"><a href="tensors.html#boolean-operations"><i class="fa fa-check"></i><b>3.2</b> Boolean operations</a></li>
<li class="chapter" data-level="3.3" data-path="tensors.html"><a href="tensors.html#slicing"><i class="fa fa-check"></i><b>3.3</b> Slicing</a></li>
<li class="chapter" data-level="3.4" data-path="tensors.html"><a href="tensors.html#example-1"><i class="fa fa-check"></i><b>3.4</b> Example</a><ul>
<li class="chapter" data-level="3.4.1" data-path="tensors.html"><a href="tensors.html#load-the-libraries"><i class="fa fa-check"></i><b>3.4.1</b> Load the libraries</a></li>
<li class="chapter" data-level="3.4.2" data-path="tensors.html"><a href="tensors.html#datasets"><i class="fa fa-check"></i><b>3.4.2</b> Datasets</a></li>
<li class="chapter" data-level="3.4.3" data-path="tensors.html"><a href="tensors.html#run-the-model"><i class="fa fa-check"></i><b>3.4.3</b> Run the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linearalgebra.html"><a href="linearalgebra.html"><i class="fa fa-check"></i><b>4</b> Linear Algebra with Torch</a><ul>
<li class="chapter" data-level="4.1" data-path="linearalgebra.html"><a href="linearalgebra.html#scalars"><i class="fa fa-check"></i><b>4.1</b> Scalars</a></li>
<li class="chapter" data-level="4.2" data-path="linearalgebra.html"><a href="linearalgebra.html#vectors"><i class="fa fa-check"></i><b>4.2</b> Vectors</a></li>
<li class="chapter" data-level="4.3" data-path="linearalgebra.html"><a href="linearalgebra.html#matrices"><i class="fa fa-check"></i><b>4.3</b> Matrices</a></li>
<li class="chapter" data-level="4.4" data-path="linearalgebra.html"><a href="linearalgebra.html#d-tensors"><i class="fa fa-check"></i><b>4.4</b> 3D+ tensors</a></li>
<li class="chapter" data-level="4.5" data-path="linearalgebra.html"><a href="linearalgebra.html#transpose-of-a-matrix"><i class="fa fa-check"></i><b>4.5</b> Transpose of a matrix</a></li>
<li class="chapter" data-level="4.6" data-path="linearalgebra.html"><a href="linearalgebra.html#vectors-special-case-of-a-matrix"><i class="fa fa-check"></i><b>4.6</b> Vectors, special case of a matrix</a></li>
<li class="chapter" data-level="4.7" data-path="linearalgebra.html"><a href="linearalgebra.html#tensor-arithmetic"><i class="fa fa-check"></i><b>4.7</b> Tensor arithmetic</a></li>
<li class="chapter" data-level="4.8" data-path="linearalgebra.html"><a href="linearalgebra.html#add-a-scalar-to-a-tensor"><i class="fa fa-check"></i><b>4.8</b> Add a scalar to a tensor</a></li>
<li class="chapter" data-level="4.9" data-path="linearalgebra.html"><a href="linearalgebra.html#multiplying-tensors"><i class="fa fa-check"></i><b>4.9</b> Multiplying tensors</a></li>
<li class="chapter" data-level="4.10" data-path="linearalgebra.html"><a href="linearalgebra.html#dot-product"><i class="fa fa-check"></i><b>4.10</b> Dot product</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>5</b> Linear Regression</a><ul>
<li class="chapter" data-level="5.1" data-path="linear-regression.html"><a href="linear-regression.html#case-1-simple-linear-regression"><i class="fa fa-check"></i><b>5.1</b> Case 1: simple linear regression</a><ul>
<li class="chapter" data-level="5.1.1" data-path="linear-regression.html"><a href="linear-regression.html#creating-the-network-model"><i class="fa fa-check"></i><b>5.1.1</b> Creating the network model</a></li>
<li class="chapter" data-level="5.1.2" data-path="linear-regression.html"><a href="linear-regression.html#datasets-1"><i class="fa fa-check"></i><b>5.1.2</b> Datasets</a></li>
<li class="chapter" data-level="5.1.3" data-path="linear-regression.html"><a href="linear-regression.html#converting-from-numpy-to-tensor"><i class="fa fa-check"></i><b>5.1.3</b> Converting from numpy to tensor</a></li>
<li class="chapter" data-level="5.1.4" data-path="linear-regression.html"><a href="linear-regression.html#optimizer-and-loss"><i class="fa fa-check"></i><b>5.1.4</b> Optimizer and Loss</a></li>
<li class="chapter" data-level="5.1.5" data-path="linear-regression.html"><a href="linear-regression.html#training"><i class="fa fa-check"></i><b>5.1.5</b> Training</a></li>
<li class="chapter" data-level="5.1.6" data-path="linear-regression.html"><a href="linear-regression.html#result"><i class="fa fa-check"></i><b>5.1.6</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linear-regression.html"><a href="linear-regression.html#case-2-rainfall"><i class="fa fa-check"></i><b>5.2</b> Case 2: Rainfall</a><ul>
<li class="chapter" data-level="5.2.1" data-path="linear-regression.html"><a href="linear-regression.html#select-device"><i class="fa fa-check"></i><b>5.2.1</b> Select device</a></li>
<li class="chapter" data-level="5.2.2" data-path="linear-regression.html"><a href="linear-regression.html#training-data"><i class="fa fa-check"></i><b>5.2.2</b> Training data</a></li>
<li class="chapter" data-level="5.2.3" data-path="linear-regression.html"><a href="linear-regression.html#convert-to-tensors"><i class="fa fa-check"></i><b>5.2.3</b> Convert to tensors</a></li>
<li class="chapter" data-level="5.2.4" data-path="linear-regression.html"><a href="linear-regression.html#build-the-model"><i class="fa fa-check"></i><b>5.2.4</b> Build the model</a></li>
<li class="chapter" data-level="5.2.5" data-path="linear-regression.html"><a href="linear-regression.html#generate-predictions"><i class="fa fa-check"></i><b>5.2.5</b> Generate predictions</a></li>
<li class="chapter" data-level="5.2.6" data-path="linear-regression.html"><a href="linear-regression.html#loss-function"><i class="fa fa-check"></i><b>5.2.6</b> Loss Function</a></li>
<li class="chapter" data-level="5.2.7" data-path="linear-regression.html"><a href="linear-regression.html#compute-gradients"><i class="fa fa-check"></i><b>5.2.7</b> Compute Gradients</a></li>
<li class="chapter" data-level="5.2.8" data-path="linear-regression.html"><a href="linear-regression.html#adjust-weights-and-biases-using-gradient-descent"><i class="fa fa-check"></i><b>5.2.8</b> Adjust weights and biases using gradient descent</a></li>
<li class="chapter" data-level="5.2.9" data-path="linear-regression.html"><a href="linear-regression.html#train-for-multiple-epochs"><i class="fa fa-check"></i><b>5.2.9</b> Train for multiple epochs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> Logistic Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#example-1-mnist-handwritten-digits"><i class="fa fa-check"></i><b>6.1</b> Example 1: MNIST handwritten digits</a><ul>
<li class="chapter" data-level="6.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#hyperparameters"><i class="fa fa-check"></i><b>6.1.1</b> Hyperparameters</a></li>
<li class="chapter" data-level="6.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#read-datasets"><i class="fa fa-check"></i><b>6.1.2</b> Read datasets</a></li>
<li class="chapter" data-level="6.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#define-the-model"><i class="fa fa-check"></i><b>6.1.3</b> Define the model</a></li>
<li class="chapter" data-level="6.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#training-1"><i class="fa fa-check"></i><b>6.1.4</b> Training</a></li>
<li class="chapter" data-level="6.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#prediction"><i class="fa fa-check"></i><b>6.1.5</b> Prediction</a></li>
<li class="chapter" data-level="6.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#save-the-model"><i class="fa fa-check"></i><b>6.1.6</b> Save the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="neural-networks.html"><a href="neural-networks.html"><i class="fa fa-check"></i><b>7</b> Neural Networks</a><ul>
<li class="chapter" data-level="7.1" data-path="neural-networks.html"><a href="neural-networks.html#code-in-rtorch"><i class="fa fa-check"></i><b>7.1</b> Code in rTorch</a><ul>
<li class="chapter" data-level="7.1.1" data-path="neural-networks.html"><a href="neural-networks.html#select-device-1"><i class="fa fa-check"></i><b>7.1.1</b> Select device</a></li>
<li class="chapter" data-level="7.1.2" data-path="neural-networks.html"><a href="neural-networks.html#create-the-datasets"><i class="fa fa-check"></i><b>7.1.2</b> Create the datasets</a></li>
<li class="chapter" data-level="7.1.3" data-path="neural-networks.html"><a href="neural-networks.html#define-the-model-1"><i class="fa fa-check"></i><b>7.1.3</b> Define the model</a></li>
<li class="chapter" data-level="7.1.4" data-path="neural-networks.html"><a href="neural-networks.html#loss-function-1"><i class="fa fa-check"></i><b>7.1.4</b> Loss function</a></li>
<li class="chapter" data-level="7.1.5" data-path="neural-networks.html"><a href="neural-networks.html#iterate-through-batches"><i class="fa fa-check"></i><b>7.1.5</b> Iterate through batches</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="datasets-in-pytorch.html"><a href="datasets-in-pytorch.html"><i class="fa fa-check"></i><b>8</b> Datasets in PyTorch</a></li>
<li class="chapter" data-level="9" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html"><i class="fa fa-check"></i><b>9</b> Simple Regression with PyTorch</a><ul>
<li class="chapter" data-level="9.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#creating-the-network-model-1"><i class="fa fa-check"></i><b>9.1</b> Creating the network model</a><ul>
<li class="chapter" data-level="9.1.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r"><i class="fa fa-check"></i><b>9.1.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#datasets-2"><i class="fa fa-check"></i><b>9.2</b> Datasets</a><ul>
<li class="chapter" data-level="9.2.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-1"><i class="fa fa-check"></i><b>9.2.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#optimizer-and-loss-1"><i class="fa fa-check"></i><b>9.3</b> Optimizer and Loss</a><ul>
<li class="chapter" data-level="9.3.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#equivalent-code-in-r"><i class="fa fa-check"></i><b>9.3.1</b> Equivalent code in R</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#training-2"><i class="fa fa-check"></i><b>9.4</b> Training</a><ul>
<li class="chapter" data-level="9.4.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-python"><i class="fa fa-check"></i><b>9.4.1</b> Code in Python</a></li>
<li class="chapter" data-level="9.4.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-2"><i class="fa fa-check"></i><b>9.4.2</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#result-1"><i class="fa fa-check"></i><b>9.5</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html"><i class="fa fa-check"></i>Bookdown tips</a><ul>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#label-references"><i class="fa fa-check"></i>Label references</a></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#figures-and-tables-with-references"><i class="fa fa-check"></i>Figures and Tables with references</a></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#long-captions"><i class="fa fa-check"></i>Long captions</a></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#citations-and-bibiliography"><i class="fa fa-check"></i>Citations and Bibiliography</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal rTorch Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lessons-learned" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Lessons Learned</h1>
<p>This chapter will explain the main differences between PyTorch and rTorch.
Most of the things work direclty in PyTorch but we need to be aware of some minor differences when working with rTorch.</p>
<p>Here is a review of existing methods.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(rTorch)</a></code></pre></div>
<div id="enumeration" class="section level2">
<h2><span class="header-section-number">2.1</span> Enumeration</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">x_train =<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="fl">3.3</span>, <span class="fl">4.4</span>, <span class="fl">5.5</span>, <span class="fl">6.71</span>, <span class="fl">6.93</span>, <span class="fl">4.168</span>, </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">                  <span class="fl">9.779</span>, <span class="fl">6.182</span>, <span class="fl">7.59</span>, <span class="fl">2.167</span>, <span class="fl">7.042</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">                  <span class="fl">10.791</span>, <span class="fl">5.313</span>, <span class="fl">7.997</span>, <span class="fl">3.1</span>), <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">x_train &lt;-<span class="st"> </span><span class="kw">r_to_py</span>(x_train)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">x_train =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(x_train)         <span class="co"># convert to tensor</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">x_train =<span class="st"> </span>x_train<span class="op">$</span><span class="kw">type</span>(torch<span class="op">$</span>FloatTensor)   <span class="co"># make it a a FloatTensor</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">x_train</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">#&gt; tensor([[ 3.3000],</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt;         [ 4.4000],</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;         [ 5.5000],</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;         [ 6.7100],</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt;         [ 6.9300],</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">#&gt;         [ 4.1680],</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">#&gt;         [ 9.7790],</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">#&gt;         [ 6.1820],</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt;         [ 7.5900],</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">#&gt;         [ 2.1670],</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">#&gt;         [ 7.0420],</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">#&gt;         [10.7910],</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"><span class="co">#&gt;         [ 5.3130],</span></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">#&gt;         [ 7.9970],</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">#&gt;         [ 3.1000]])</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">x_train<span class="op">$</span><span class="kw">nelement</span>()    <span class="co"># number of elements in the tensor</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] 15</span></a></code></pre></div>
</div>
<div id="how-to-iterate-a-generator" class="section level2">
<h2><span class="header-section-number">2.2</span> How to iterate a generator</h2>
<div id="using-enumerate-and-iterate" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Using <code>enumerate</code> and <code>iterate</code></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">py =<span class="st"> </span><span class="kw">import_builtins</span>()</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">xx =<span class="st"> </span>py<span class="op">$</span><span class="kw">enumerate</span>(x_train)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">xit =<span class="st"> </span><span class="kw">iterate</span>(xx, <span class="dt">simplify =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">xit</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; [[1]][[1]]</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; [[1]][[2]]</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; tensor([3.3000])</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt; [[2]][[1]]</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co">#&gt; [[2]][[2]]</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="co">#&gt; tensor([4.4000])</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="co">#&gt; [[3]]</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; [[3]][[1]]</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; [1] 2</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt; [[3]][[2]]</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt; tensor([5.5000])</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt; [[4]]</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt; [[4]][[1]]</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; [[4]][[2]]</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"><span class="co">#&gt; tensor([6.7100])</span></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-38" data-line-number="38"><span class="co">#&gt; [[5]]</span></a>
<a class="sourceLine" id="cb6-39" data-line-number="39"><span class="co">#&gt; [[5]][[1]]</span></a>
<a class="sourceLine" id="cb6-40" data-line-number="40"><span class="co">#&gt; [1] 4</span></a>
<a class="sourceLine" id="cb6-41" data-line-number="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-42" data-line-number="42"><span class="co">#&gt; [[5]][[2]]</span></a>
<a class="sourceLine" id="cb6-43" data-line-number="43"><span class="co">#&gt; tensor([6.9300])</span></a>
<a class="sourceLine" id="cb6-44" data-line-number="44"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-45" data-line-number="45"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-46" data-line-number="46"><span class="co">#&gt; [[6]]</span></a>
<a class="sourceLine" id="cb6-47" data-line-number="47"><span class="co">#&gt; [[6]][[1]]</span></a>
<a class="sourceLine" id="cb6-48" data-line-number="48"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb6-49" data-line-number="49"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-50" data-line-number="50"><span class="co">#&gt; [[6]][[2]]</span></a>
<a class="sourceLine" id="cb6-51" data-line-number="51"><span class="co">#&gt; tensor([4.1680])</span></a>
<a class="sourceLine" id="cb6-52" data-line-number="52"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-53" data-line-number="53"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-54" data-line-number="54"><span class="co">#&gt; [[7]]</span></a>
<a class="sourceLine" id="cb6-55" data-line-number="55"><span class="co">#&gt; [[7]][[1]]</span></a>
<a class="sourceLine" id="cb6-56" data-line-number="56"><span class="co">#&gt; [1] 6</span></a>
<a class="sourceLine" id="cb6-57" data-line-number="57"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-58" data-line-number="58"><span class="co">#&gt; [[7]][[2]]</span></a>
<a class="sourceLine" id="cb6-59" data-line-number="59"><span class="co">#&gt; tensor([9.7790])</span></a>
<a class="sourceLine" id="cb6-60" data-line-number="60"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-61" data-line-number="61"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-62" data-line-number="62"><span class="co">#&gt; [[8]]</span></a>
<a class="sourceLine" id="cb6-63" data-line-number="63"><span class="co">#&gt; [[8]][[1]]</span></a>
<a class="sourceLine" id="cb6-64" data-line-number="64"><span class="co">#&gt; [1] 7</span></a>
<a class="sourceLine" id="cb6-65" data-line-number="65"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-66" data-line-number="66"><span class="co">#&gt; [[8]][[2]]</span></a>
<a class="sourceLine" id="cb6-67" data-line-number="67"><span class="co">#&gt; tensor([6.1820])</span></a>
<a class="sourceLine" id="cb6-68" data-line-number="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-69" data-line-number="69"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-70" data-line-number="70"><span class="co">#&gt; [[9]]</span></a>
<a class="sourceLine" id="cb6-71" data-line-number="71"><span class="co">#&gt; [[9]][[1]]</span></a>
<a class="sourceLine" id="cb6-72" data-line-number="72"><span class="co">#&gt; [1] 8</span></a>
<a class="sourceLine" id="cb6-73" data-line-number="73"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-74" data-line-number="74"><span class="co">#&gt; [[9]][[2]]</span></a>
<a class="sourceLine" id="cb6-75" data-line-number="75"><span class="co">#&gt; tensor([7.5900])</span></a>
<a class="sourceLine" id="cb6-76" data-line-number="76"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-77" data-line-number="77"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-78" data-line-number="78"><span class="co">#&gt; [[10]]</span></a>
<a class="sourceLine" id="cb6-79" data-line-number="79"><span class="co">#&gt; [[10]][[1]]</span></a>
<a class="sourceLine" id="cb6-80" data-line-number="80"><span class="co">#&gt; [1] 9</span></a>
<a class="sourceLine" id="cb6-81" data-line-number="81"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-82" data-line-number="82"><span class="co">#&gt; [[10]][[2]]</span></a>
<a class="sourceLine" id="cb6-83" data-line-number="83"><span class="co">#&gt; tensor([2.1670])</span></a>
<a class="sourceLine" id="cb6-84" data-line-number="84"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-85" data-line-number="85"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-86" data-line-number="86"><span class="co">#&gt; [[11]]</span></a>
<a class="sourceLine" id="cb6-87" data-line-number="87"><span class="co">#&gt; [[11]][[1]]</span></a>
<a class="sourceLine" id="cb6-88" data-line-number="88"><span class="co">#&gt; [1] 10</span></a>
<a class="sourceLine" id="cb6-89" data-line-number="89"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-90" data-line-number="90"><span class="co">#&gt; [[11]][[2]]</span></a>
<a class="sourceLine" id="cb6-91" data-line-number="91"><span class="co">#&gt; tensor([7.0420])</span></a>
<a class="sourceLine" id="cb6-92" data-line-number="92"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-93" data-line-number="93"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-94" data-line-number="94"><span class="co">#&gt; [[12]]</span></a>
<a class="sourceLine" id="cb6-95" data-line-number="95"><span class="co">#&gt; [[12]][[1]]</span></a>
<a class="sourceLine" id="cb6-96" data-line-number="96"><span class="co">#&gt; [1] 11</span></a>
<a class="sourceLine" id="cb6-97" data-line-number="97"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-98" data-line-number="98"><span class="co">#&gt; [[12]][[2]]</span></a>
<a class="sourceLine" id="cb6-99" data-line-number="99"><span class="co">#&gt; tensor([10.7910])</span></a>
<a class="sourceLine" id="cb6-100" data-line-number="100"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-101" data-line-number="101"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-102" data-line-number="102"><span class="co">#&gt; [[13]]</span></a>
<a class="sourceLine" id="cb6-103" data-line-number="103"><span class="co">#&gt; [[13]][[1]]</span></a>
<a class="sourceLine" id="cb6-104" data-line-number="104"><span class="co">#&gt; [1] 12</span></a>
<a class="sourceLine" id="cb6-105" data-line-number="105"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-106" data-line-number="106"><span class="co">#&gt; [[13]][[2]]</span></a>
<a class="sourceLine" id="cb6-107" data-line-number="107"><span class="co">#&gt; tensor([5.3130])</span></a>
<a class="sourceLine" id="cb6-108" data-line-number="108"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-109" data-line-number="109"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-110" data-line-number="110"><span class="co">#&gt; [[14]]</span></a>
<a class="sourceLine" id="cb6-111" data-line-number="111"><span class="co">#&gt; [[14]][[1]]</span></a>
<a class="sourceLine" id="cb6-112" data-line-number="112"><span class="co">#&gt; [1] 13</span></a>
<a class="sourceLine" id="cb6-113" data-line-number="113"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-114" data-line-number="114"><span class="co">#&gt; [[14]][[2]]</span></a>
<a class="sourceLine" id="cb6-115" data-line-number="115"><span class="co">#&gt; tensor([7.9970])</span></a>
<a class="sourceLine" id="cb6-116" data-line-number="116"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-117" data-line-number="117"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-118" data-line-number="118"><span class="co">#&gt; [[15]]</span></a>
<a class="sourceLine" id="cb6-119" data-line-number="119"><span class="co">#&gt; [[15]][[1]]</span></a>
<a class="sourceLine" id="cb6-120" data-line-number="120"><span class="co">#&gt; [1] 14</span></a>
<a class="sourceLine" id="cb6-121" data-line-number="121"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-122" data-line-number="122"><span class="co">#&gt; [[15]][[2]]</span></a>
<a class="sourceLine" id="cb6-123" data-line-number="123"><span class="co">#&gt; tensor([3.1000])</span></a></code></pre></div>
</div>
<div id="using-a-for-loop" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Using a <code>for-loop</code></h3>
</div>
</div>
<div id="zero-gradient" class="section level2">
<h2><span class="header-section-number">2.3</span> Zero gradient</h2>
<p>The zero gradient was one of the most difficult to implement in R.</p>
</div>
<div id="transform-a-tensor" class="section level2">
<h2><span class="header-section-number">2.4</span> Transform a tensor</h2>
<p>Explain how transform a tensor back and forth to <code>numpy</code>.
Why is this important?</p>
</div>
<div id="build-a-model-class" class="section level2">
<h2><span class="header-section-number">2.5</span> Build a model class</h2>
<p>PyTorch classes cannot not directly instantiated from <code>R</code>. We need an intermediate step to create a class. For this, we use <code>reticulate</code> functions that will read the class implementation in <code>Python</code> code.</p>
<div id="examples" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Examples</h3>
</div>
</div>
<div id="convert-a-tensor-to-numpy-object" class="section level2">
<h2><span class="header-section-number">2.6</span> Convert a tensor to <code>numpy</code> object</h2>
<p>This is a frequent operation. I have found that this is necessary when</p>
<ul>
<li>a numpy function is not implemented in PyTorch</li>
<li>We need to convert a tensor to R</li>
<li>Perform a boolean operation that is not directly available in PyTorch.</li>
</ul>
</div>
<div id="convert-a-numpy-object-to-an-r-object" class="section level2">
<h2><span class="header-section-number">2.7</span> Convert a <code>numpy</code> object to an <code>R</code> object</h2>
<p>This is mainly required for these reasons:</p>
<ol style="list-style-type: decimal">
<li>Create a data structure in R</li>
<li>Plot using r-base or ggplot2</li>
<li>Perform an analysis on parts of a tensor</li>
<li>Use R statistical functions that are not available in PyTorch.</li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tensors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["rtorch-book.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
