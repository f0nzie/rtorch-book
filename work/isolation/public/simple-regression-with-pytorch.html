<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 10 Simple Regression with PyTorch | A Minimal rTorch Tutorial</title>
  <meta name="description" content="This is a minimal tutorial of using the rTorch package to have fun while doing machine learning. This book was produced with bookdown." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 10 Simple Regression with PyTorch | A Minimal rTorch Tutorial" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal tutorial of using the rTorch package to have fun while doing machine learning. This book was produced with bookdown." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 10 Simple Regression with PyTorch | A Minimal rTorch Tutorial" />
  
  <meta name="twitter:description" content="This is a minimal tutorial of using the rTorch package to have fun while doing machine learning. This book was produced with bookdown." />
  

<meta name="author" content="Alfonso R. Reyes" />


<meta name="date" content="2019-09-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="datasets-in-pytorch.html"/>
<link rel="next" href="bookdown-tips.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal rTorch Tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites {-}</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i>Installation</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#python-anaconda"><i class="fa fa-check"></i>Python Anaconda</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#example"><i class="fa fa-check"></i>Example</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#automatic-installation"><i class="fa fa-check"></i>Automatic installation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#motivation"><i class="fa fa-check"></i><b>2.1</b> Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#how-do-we-start-using-rtorch"><i class="fa fa-check"></i><b>2.2</b> How do we start using <code>rTorch</code></a><ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#getting-the-pytorch-version"><i class="fa fa-check"></i><b>2.2.1</b> Getting the PyTorch version</a></li>
<li class="chapter" data-level="2.2.2" data-path="intro.html"><a href="intro.html#pytorch-configuration"><i class="fa fa-check"></i><b>2.2.2</b> PyTorch configuration</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#what-can-you-do-with-rtorch"><i class="fa fa-check"></i><b>2.3</b> What can you do with <code>rTorch</code></a><ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#the-torchvision-module"><i class="fa fa-check"></i><b>2.3.1</b> The <code>torchvision</code> module</a></li>
<li class="chapter" data-level="2.3.2" data-path="intro.html"><a href="intro.html#np-the-numpy-module"><i class="fa fa-check"></i><b>2.3.2</b> <code>np</code>: the <code>numpy</code> module</a></li>
<li class="chapter" data-level="2.3.3" data-path="intro.html"><a href="intro.html#python-built-in-functions"><i class="fa fa-check"></i><b>2.3.3</b> Python built-in functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lessons-learned.html"><a href="lessons-learned.html"><i class="fa fa-check"></i><b>3</b> Lessons Learned</a><ul>
<li class="chapter" data-level="3.1" data-path="lessons-learned.html"><a href="lessons-learned.html#calling-objects-from-pytorch"><i class="fa fa-check"></i><b>3.1</b> Calling objects from PyTorch</a></li>
<li class="chapter" data-level="3.2" data-path="lessons-learned.html"><a href="lessons-learned.html#call-a-module-from-pytorch"><i class="fa fa-check"></i><b>3.2</b> Call a module from PyTorch</a></li>
<li class="chapter" data-level="3.3" data-path="lessons-learned.html"><a href="lessons-learned.html#show-the-attributes-methods-of-a-class-or-pytorch-object"><i class="fa fa-check"></i><b>3.3</b> Show the attributes (methods) of a class or PyTorch object</a></li>
<li class="chapter" data-level="3.4" data-path="lessons-learned.html"><a href="lessons-learned.html#enumeration"><i class="fa fa-check"></i><b>3.4</b> Enumeration</a></li>
<li class="chapter" data-level="3.5" data-path="lessons-learned.html"><a href="lessons-learned.html#how-to-iterate"><i class="fa fa-check"></i><b>3.5</b> How to iterate</a><ul>
<li class="chapter" data-level="3.5.1" data-path="lessons-learned.html"><a href="lessons-learned.html#using-enumerate-and-iterate"><i class="fa fa-check"></i><b>3.5.1</b> Using <code>enumerate</code> and <code>iterate</code></a></li>
<li class="chapter" data-level="3.5.2" data-path="lessons-learned.html"><a href="lessons-learned.html#using-a-for-loop-to-iterate"><i class="fa fa-check"></i><b>3.5.2</b> Using a <code>for-loop</code> to iterate</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="lessons-learned.html"><a href="lessons-learned.html#zero-gradient"><i class="fa fa-check"></i><b>3.6</b> Zero gradient</a><ul>
<li class="chapter" data-level="3.6.1" data-path="lessons-learned.html"><a href="lessons-learned.html#version-in-python"><i class="fa fa-check"></i><b>3.6.1</b> Version in Python</a></li>
<li class="chapter" data-level="3.6.2" data-path="lessons-learned.html"><a href="lessons-learned.html#version-in-r"><i class="fa fa-check"></i><b>3.6.2</b> Version in R</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="lessons-learned.html"><a href="lessons-learned.html#transform-a-tensor"><i class="fa fa-check"></i><b>3.7</b> Transform a tensor</a></li>
<li class="chapter" data-level="3.8" data-path="lessons-learned.html"><a href="lessons-learned.html#build-a-model-class"><i class="fa fa-check"></i><b>3.8</b> Build a model class</a><ul>
<li class="chapter" data-level="3.8.1" data-path="lessons-learned.html"><a href="lessons-learned.html#example-1"><i class="fa fa-check"></i><b>3.8.1</b> Example 1</a></li>
<li class="chapter" data-level="3.8.2" data-path="lessons-learned.html"><a href="lessons-learned.html#example-2"><i class="fa fa-check"></i><b>3.8.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="lessons-learned.html"><a href="lessons-learned.html#convert-a-tensor-to-numpy-object"><i class="fa fa-check"></i><b>3.9</b> Convert a tensor to <code>numpy</code> object</a></li>
<li class="chapter" data-level="3.10" data-path="lessons-learned.html"><a href="lessons-learned.html#convert-a-numpy-object-to-an-r-object"><i class="fa fa-check"></i><b>3.10</b> Convert a <code>numpy</code> object to an <code>R</code> object</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tensors.html"><a href="tensors.html"><i class="fa fa-check"></i><b>4</b> Tensors</a><ul>
<li class="chapter" data-level="4.1" data-path="tensors.html"><a href="tensors.html#arithmetic-of-tensors"><i class="fa fa-check"></i><b>4.1</b> Arithmetic of tensors</a></li>
<li class="chapter" data-level="4.2" data-path="tensors.html"><a href="tensors.html#boolean-operations"><i class="fa fa-check"></i><b>4.2</b> Boolean operations</a></li>
<li class="chapter" data-level="4.3" data-path="tensors.html"><a href="tensors.html#slicing"><i class="fa fa-check"></i><b>4.3</b> Slicing</a></li>
<li class="chapter" data-level="4.4" data-path="tensors.html"><a href="tensors.html#example-3"><i class="fa fa-check"></i><b>4.4</b> Example</a><ul>
<li class="chapter" data-level="4.4.1" data-path="tensors.html"><a href="tensors.html#load-the-libraries"><i class="fa fa-check"></i><b>4.4.1</b> Load the libraries</a></li>
<li class="chapter" data-level="4.4.2" data-path="tensors.html"><a href="tensors.html#datasets"><i class="fa fa-check"></i><b>4.4.2</b> Datasets</a></li>
<li class="chapter" data-level="4.4.3" data-path="tensors.html"><a href="tensors.html#run-the-model"><i class="fa fa-check"></i><b>4.4.3</b> Run the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linearalgebra.html"><a href="linearalgebra.html"><i class="fa fa-check"></i><b>5</b> Linear Algebra with Torch</a><ul>
<li class="chapter" data-level="5.1" data-path="linearalgebra.html"><a href="linearalgebra.html#scalars"><i class="fa fa-check"></i><b>5.1</b> Scalars</a></li>
<li class="chapter" data-level="5.2" data-path="linearalgebra.html"><a href="linearalgebra.html#vectors"><i class="fa fa-check"></i><b>5.2</b> Vectors</a></li>
<li class="chapter" data-level="5.3" data-path="linearalgebra.html"><a href="linearalgebra.html#matrices"><i class="fa fa-check"></i><b>5.3</b> Matrices</a></li>
<li class="chapter" data-level="5.4" data-path="linearalgebra.html"><a href="linearalgebra.html#d-tensors"><i class="fa fa-check"></i><b>5.4</b> 3D+ tensors</a></li>
<li class="chapter" data-level="5.5" data-path="linearalgebra.html"><a href="linearalgebra.html#transpose-of-a-matrix"><i class="fa fa-check"></i><b>5.5</b> Transpose of a matrix</a></li>
<li class="chapter" data-level="5.6" data-path="linearalgebra.html"><a href="linearalgebra.html#vectors-special-case-of-a-matrix"><i class="fa fa-check"></i><b>5.6</b> Vectors, special case of a matrix</a></li>
<li class="chapter" data-level="5.7" data-path="linearalgebra.html"><a href="linearalgebra.html#tensor-arithmetic"><i class="fa fa-check"></i><b>5.7</b> Tensor arithmetic</a></li>
<li class="chapter" data-level="5.8" data-path="linearalgebra.html"><a href="linearalgebra.html#add-a-scalar-to-a-tensor"><i class="fa fa-check"></i><b>5.8</b> Add a scalar to a tensor</a></li>
<li class="chapter" data-level="5.9" data-path="linearalgebra.html"><a href="linearalgebra.html#multiplying-tensors"><i class="fa fa-check"></i><b>5.9</b> Multiplying tensors</a></li>
<li class="chapter" data-level="5.10" data-path="linearalgebra.html"><a href="linearalgebra.html#dot-product"><i class="fa fa-check"></i><b>5.10</b> Dot product</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>6</b> Linear Regression</a><ul>
<li class="chapter" data-level="6.1" data-path="linear-regression.html"><a href="linear-regression.html#case-1-simple-linear-regression"><i class="fa fa-check"></i><b>6.1</b> Case 1: simple linear regression</a><ul>
<li class="chapter" data-level="6.1.1" data-path="linear-regression.html"><a href="linear-regression.html#creating-the-network-model"><i class="fa fa-check"></i><b>6.1.1</b> Creating the network model</a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-regression.html"><a href="linear-regression.html#datasets-1"><i class="fa fa-check"></i><b>6.1.2</b> Datasets</a></li>
<li class="chapter" data-level="6.1.3" data-path="linear-regression.html"><a href="linear-regression.html#converting-from-numpy-to-tensor"><i class="fa fa-check"></i><b>6.1.3</b> Converting from numpy to tensor</a></li>
<li class="chapter" data-level="6.1.4" data-path="linear-regression.html"><a href="linear-regression.html#optimizer-and-loss"><i class="fa fa-check"></i><b>6.1.4</b> Optimizer and Loss</a></li>
<li class="chapter" data-level="6.1.5" data-path="linear-regression.html"><a href="linear-regression.html#training"><i class="fa fa-check"></i><b>6.1.5</b> Training</a></li>
<li class="chapter" data-level="6.1.6" data-path="linear-regression.html"><a href="linear-regression.html#result"><i class="fa fa-check"></i><b>6.1.6</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-regression.html"><a href="linear-regression.html#case-2-rainfall"><i class="fa fa-check"></i><b>6.2</b> Case 2: Rainfall</a><ul>
<li class="chapter" data-level="6.2.1" data-path="linear-regression.html"><a href="linear-regression.html#select-device"><i class="fa fa-check"></i><b>6.2.1</b> Select device</a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-regression.html"><a href="linear-regression.html#training-data"><i class="fa fa-check"></i><b>6.2.2</b> Training data</a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-regression.html"><a href="linear-regression.html#convert-to-tensors"><i class="fa fa-check"></i><b>6.2.3</b> Convert to tensors</a></li>
<li class="chapter" data-level="6.2.4" data-path="linear-regression.html"><a href="linear-regression.html#build-the-model"><i class="fa fa-check"></i><b>6.2.4</b> Build the model</a></li>
<li class="chapter" data-level="6.2.5" data-path="linear-regression.html"><a href="linear-regression.html#generate-predictions"><i class="fa fa-check"></i><b>6.2.5</b> Generate predictions</a></li>
<li class="chapter" data-level="6.2.6" data-path="linear-regression.html"><a href="linear-regression.html#loss-function"><i class="fa fa-check"></i><b>6.2.6</b> Loss Function</a></li>
<li class="chapter" data-level="6.2.7" data-path="linear-regression.html"><a href="linear-regression.html#compute-gradients"><i class="fa fa-check"></i><b>6.2.7</b> Compute Gradients</a></li>
<li class="chapter" data-level="6.2.8" data-path="linear-regression.html"><a href="linear-regression.html#adjust-weights-and-biases-using-gradient-descent"><i class="fa fa-check"></i><b>6.2.8</b> Adjust weights and biases using gradient descent</a></li>
<li class="chapter" data-level="6.2.9" data-path="linear-regression.html"><a href="linear-regression.html#train-for-multiple-epochs"><i class="fa fa-check"></i><b>6.2.9</b> Train for multiple epochs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>7</b> Logistic Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="logistic-regression.html"><a href="logistic-regression.html#example-1-mnist-handwritten-digits"><i class="fa fa-check"></i><b>7.1</b> Example 1: MNIST handwritten digits</a><ul>
<li class="chapter" data-level="7.1.1" data-path="logistic-regression.html"><a href="logistic-regression.html#hyperparameters"><i class="fa fa-check"></i><b>7.1.1</b> Hyperparameters</a></li>
<li class="chapter" data-level="7.1.2" data-path="logistic-regression.html"><a href="logistic-regression.html#read-datasets"><i class="fa fa-check"></i><b>7.1.2</b> Read datasets</a></li>
<li class="chapter" data-level="7.1.3" data-path="logistic-regression.html"><a href="logistic-regression.html#define-the-model"><i class="fa fa-check"></i><b>7.1.3</b> Define the model</a></li>
<li class="chapter" data-level="7.1.4" data-path="logistic-regression.html"><a href="logistic-regression.html#training-1"><i class="fa fa-check"></i><b>7.1.4</b> Training</a></li>
<li class="chapter" data-level="7.1.5" data-path="logistic-regression.html"><a href="logistic-regression.html#prediction"><i class="fa fa-check"></i><b>7.1.5</b> Prediction</a></li>
<li class="chapter" data-level="7.1.6" data-path="logistic-regression.html"><a href="logistic-regression.html#save-the-model"><i class="fa fa-check"></i><b>7.1.6</b> Save the model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="neural-networks.html"><a href="neural-networks.html"><i class="fa fa-check"></i><b>8</b> Neural Networks</a><ul>
<li class="chapter" data-level="8.1" data-path="neural-networks.html"><a href="neural-networks.html#code-in-rtorch"><i class="fa fa-check"></i><b>8.1</b> Code in rTorch</a><ul>
<li class="chapter" data-level="8.1.1" data-path="neural-networks.html"><a href="neural-networks.html#select-device-1"><i class="fa fa-check"></i><b>8.1.1</b> Select device</a></li>
<li class="chapter" data-level="8.1.2" data-path="neural-networks.html"><a href="neural-networks.html#create-the-datasets"><i class="fa fa-check"></i><b>8.1.2</b> Create the datasets</a></li>
<li class="chapter" data-level="8.1.3" data-path="neural-networks.html"><a href="neural-networks.html#define-the-model-1"><i class="fa fa-check"></i><b>8.1.3</b> Define the model</a></li>
<li class="chapter" data-level="8.1.4" data-path="neural-networks.html"><a href="neural-networks.html#loss-function-1"><i class="fa fa-check"></i><b>8.1.4</b> Loss function</a></li>
<li class="chapter" data-level="8.1.5" data-path="neural-networks.html"><a href="neural-networks.html#iterate-through-batches"><i class="fa fa-check"></i><b>8.1.5</b> Iterate through batches</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="datasets-in-pytorch.html"><a href="datasets-in-pytorch.html"><i class="fa fa-check"></i><b>9</b> Datasets in PyTorch</a></li>
<li class="chapter" data-level="10" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html"><i class="fa fa-check"></i><b>10</b> Simple Regression with PyTorch</a><ul>
<li class="chapter" data-level="10.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#creating-the-network-model-1"><i class="fa fa-check"></i><b>10.1</b> Creating the network model</a><ul>
<li class="chapter" data-level="10.1.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r"><i class="fa fa-check"></i><b>10.1.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#datasets-2"><i class="fa fa-check"></i><b>10.2</b> Datasets</a><ul>
<li class="chapter" data-level="10.2.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-1"><i class="fa fa-check"></i><b>10.2.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#optimizer-and-loss-1"><i class="fa fa-check"></i><b>10.3</b> Optimizer and Loss</a><ul>
<li class="chapter" data-level="10.3.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#equivalent-code-in-r"><i class="fa fa-check"></i><b>10.3.1</b> Equivalent code in R</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#training-2"><i class="fa fa-check"></i><b>10.4</b> Training</a><ul>
<li class="chapter" data-level="10.4.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-python"><i class="fa fa-check"></i><b>10.4.1</b> Code in Python</a></li>
<li class="chapter" data-level="10.4.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-2"><i class="fa fa-check"></i><b>10.4.2</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#result-1"><i class="fa fa-check"></i><b>10.5</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html"><i class="fa fa-check"></i>Bookdown tips</a><ul>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#label-references"><i class="fa fa-check"></i>Label references</a></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#figures-and-tables-with-references"><i class="fa fa-check"></i>Figures and Tables with references</a></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#long-captions"><i class="fa fa-check"></i>Long captions</a></li>
<li class="chapter" data-level="" data-path="bookdown-tips.html"><a href="bookdown-tips.html#citations-and-bibiliography"><i class="fa fa-check"></i>Citations and Bibiliography</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal rTorch Tutorial</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-regression-with-pytorch" class="section level1">
<h1><span class="header-section-number">Chapter 10</span> Simple Regression with PyTorch</h1>
<p>Source: <a href="https://www.guru99.com/pytorch-tutorial.html" class="uri">https://www.guru99.com/pytorch-tutorial.html</a></p>
<div id="creating-the-network-model-1" class="section level2">
<h2><span class="header-section-number">10.1</span> Creating the network model</h2>
<p>Our network model is a simple Linear layer with an input and an output shape of 1.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="kw">library</span>(rTorch)</a></code></pre></div>
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="im">from</span> __future__ <span class="im">import</span> print_function</a>
<a class="sourceLine" id="cb118-2" data-line-number="2"></a>
<a class="sourceLine" id="cb118-3" data-line-number="3"><span class="im">import</span> torch</a>
<a class="sourceLine" id="cb118-4" data-line-number="4"><span class="im">import</span> torch.nn <span class="im">as</span> nn</a>
<a class="sourceLine" id="cb118-5" data-line-number="5"><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</a>
<a class="sourceLine" id="cb118-6" data-line-number="6"><span class="im">from</span> torch.autograd <span class="im">import</span> Variable</a>
<a class="sourceLine" id="cb118-7" data-line-number="7"></a>
<a class="sourceLine" id="cb118-8" data-line-number="8">torch.manual_seed(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb118-9" data-line-number="9"><span class="co">#&gt; &lt;torch._C.Generator object at 0x7fa5051f6a70&gt;</span></a>
<a class="sourceLine" id="cb118-10" data-line-number="10"><span class="kw">class</span> Net(nn.Module):</a>
<a class="sourceLine" id="cb118-11" data-line-number="11">   <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb118-12" data-line-number="12">       <span class="bu">super</span>(Net, <span class="va">self</span>).<span class="fu">__init__</span>()</a>
<a class="sourceLine" id="cb118-13" data-line-number="13">       <span class="va">self</span>.layer <span class="op">=</span> torch.nn.Linear(<span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb118-14" data-line-number="14"></a>
<a class="sourceLine" id="cb118-15" data-line-number="15">   <span class="kw">def</span> forward(<span class="va">self</span>, x):</a>
<a class="sourceLine" id="cb118-16" data-line-number="16">       x <span class="op">=</span> <span class="va">self</span>.layer(x)      </a>
<a class="sourceLine" id="cb118-17" data-line-number="17">       <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb118-18" data-line-number="18"></a>
<a class="sourceLine" id="cb118-19" data-line-number="19">net <span class="op">=</span> Net()</a>
<a class="sourceLine" id="cb118-20" data-line-number="20"><span class="bu">print</span>(net)</a>
<a class="sourceLine" id="cb118-21" data-line-number="21"><span class="co">#&gt; Net(</span></a>
<a class="sourceLine" id="cb118-22" data-line-number="22"><span class="co">#&gt;   (layer): Linear(in_features=1, out_features=1, bias=True)</span></a>
<a class="sourceLine" id="cb118-23" data-line-number="23"><span class="co">#&gt; )</span></a></code></pre></div>
<p>And the network output should be like this</p>
<pre><code>Net(
  (hidden): Linear(in_features=1, out_features=1, bias=True)
)</code></pre>
<div id="code-in-r" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Code in R</h3>
<p>This would be the equivalent code in R:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="kw">library</span>(reticulate)</a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb120-3" data-line-number="3"><span class="co">#&gt; Attaching package: &#39;reticulate&#39;</span></a>
<a class="sourceLine" id="cb120-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from &#39;package:rTorch&#39;:</span></a>
<a class="sourceLine" id="cb120-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb120-6" data-line-number="6"><span class="co">#&gt;     conda_install, conda_python</span></a>
<a class="sourceLine" id="cb120-7" data-line-number="7"></a>
<a class="sourceLine" id="cb120-8" data-line-number="8">torch &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch&quot;</span>)</a>
<a class="sourceLine" id="cb120-9" data-line-number="9">nn    &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch.nn&quot;</span>)</a>
<a class="sourceLine" id="cb120-10" data-line-number="10">Variable &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch.autograd&quot;</span>)<span class="op">$</span>Variable</a>
<a class="sourceLine" id="cb120-11" data-line-number="11"></a>
<a class="sourceLine" id="cb120-12" data-line-number="12">torch<span class="op">$</span><span class="kw">manual_seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb120-13" data-line-number="13"><span class="co">#&gt; &lt;torch._C.Generator&gt;</span></a>
<a class="sourceLine" id="cb120-14" data-line-number="14"></a>
<a class="sourceLine" id="cb120-15" data-line-number="15">main =<span class="st"> </span><span class="kw">py_run_string</span>(</a>
<a class="sourceLine" id="cb120-16" data-line-number="16"><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb120-17" data-line-number="17"><span class="st">import torch.nn as nn</span></a>
<a class="sourceLine" id="cb120-18" data-line-number="18"></a>
<a class="sourceLine" id="cb120-19" data-line-number="19"><span class="st">class Net(nn.Module):</span></a>
<a class="sourceLine" id="cb120-20" data-line-number="20"><span class="st">   def __init__(self):</span></a>
<a class="sourceLine" id="cb120-21" data-line-number="21"><span class="st">       super(Net, self).__init__()</span></a>
<a class="sourceLine" id="cb120-22" data-line-number="22"><span class="st">       self.layer = torch.nn.Linear(1, 1)</span></a>
<a class="sourceLine" id="cb120-23" data-line-number="23"></a>
<a class="sourceLine" id="cb120-24" data-line-number="24"><span class="st">   def forward(self, x):</span></a>
<a class="sourceLine" id="cb120-25" data-line-number="25"><span class="st">       x = self.layer(x)      </span></a>
<a class="sourceLine" id="cb120-26" data-line-number="26"><span class="st">       return x</span></a>
<a class="sourceLine" id="cb120-27" data-line-number="27"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb120-28" data-line-number="28"></a>
<a class="sourceLine" id="cb120-29" data-line-number="29"></a>
<a class="sourceLine" id="cb120-30" data-line-number="30"><span class="co"># build a Linear Rgression model</span></a>
<a class="sourceLine" id="cb120-31" data-line-number="31">net &lt;-<span class="st"> </span>main<span class="op">$</span><span class="kw">Net</span>()</a>
<a class="sourceLine" id="cb120-32" data-line-number="32"><span class="kw">print</span>(net)</a>
<a class="sourceLine" id="cb120-33" data-line-number="33"><span class="co">#&gt; Net(</span></a>
<a class="sourceLine" id="cb120-34" data-line-number="34"><span class="co">#&gt;   (layer): Linear(in_features=1, out_features=1, bias=True)</span></a>
<a class="sourceLine" id="cb120-35" data-line-number="35"><span class="co">#&gt; )</span></a></code></pre></div>
</div>
</div>
<div id="datasets-2" class="section level2">
<h2><span class="header-section-number">10.2</span> Datasets</h2>
<p>Before you start the training process, you need to know our data. You make a random function to test our model. <span class="math inline">\(Y = x3 sin(x)+ 3x+0.8 rand(100)\)</span></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb121-1" data-line-number="1"><span class="co"># Visualize our data</span></a>
<a class="sourceLine" id="cb121-2" data-line-number="2"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb121-3" data-line-number="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb121-4" data-line-number="4"></a>
<a class="sourceLine" id="cb121-5" data-line-number="5">np.random.seed(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb121-6" data-line-number="6"></a>
<a class="sourceLine" id="cb121-7" data-line-number="7">x <span class="op">=</span> np.random.rand(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb121-8" data-line-number="8">y <span class="op">=</span> np.sin(x) <span class="op">*</span> np.power(x,<span class="dv">3</span>) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x <span class="op">+</span> np.random.rand(<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb121-9" data-line-number="9"></a>
<a class="sourceLine" id="cb121-10" data-line-number="10">plt.scatter(x, y)</a>
<a class="sourceLine" id="cb121-11" data-line-number="11">plt.show()</a></code></pre></div>
<p><img src="09-simple_regression_files/figure-html/unnamed-chunk-5-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This is the code in R:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1">np    &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;numpy&quot;</span>)</a>
<a class="sourceLine" id="cb122-2" data-line-number="2"></a>
<a class="sourceLine" id="cb122-3" data-line-number="3">np<span class="op">$</span>random<span class="op">$</span><span class="kw">seed</span>(123L)</a>
<a class="sourceLine" id="cb122-4" data-line-number="4"></a>
<a class="sourceLine" id="cb122-5" data-line-number="5">x =<span class="st"> </span>np<span class="op">$</span>random<span class="op">$</span><span class="kw">rand</span>(100L)</a>
<a class="sourceLine" id="cb122-6" data-line-number="6">y =<span class="st"> </span>np<span class="op">$</span><span class="kw">sin</span>(x) <span class="op">*</span><span class="st"> </span>np<span class="op">$</span><span class="kw">power</span>(x, 3L) <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span>np<span class="op">$</span>random<span class="op">$</span><span class="kw">rand</span>(100L)<span class="op">*</span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb122-7" data-line-number="7"></a>
<a class="sourceLine" id="cb122-8" data-line-number="8"><span class="kw">plot</span>(x, y)</a></code></pre></div>
<p><img src="09-simple_regression_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Before you start the training process, you need to convert the numpy array to Variables that supported by Torch and autograd.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb123-1" data-line-number="1"><span class="co"># convert numpy array to tensor in shape of input size</span></a>
<a class="sourceLine" id="cb123-2" data-line-number="2">x <span class="op">=</span> torch.from_numpy(x.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)).<span class="bu">float</span>()</a>
<a class="sourceLine" id="cb123-3" data-line-number="3">y <span class="op">=</span> torch.from_numpy(y.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)).<span class="bu">float</span>()</a>
<a class="sourceLine" id="cb123-4" data-line-number="4"><span class="bu">print</span>(x, y)</a>
<a class="sourceLine" id="cb123-5" data-line-number="5"><span class="co">#&gt; tensor([[0.6965],</span></a>
<a class="sourceLine" id="cb123-6" data-line-number="6"><span class="co">#&gt;         [0.2861],</span></a>
<a class="sourceLine" id="cb123-7" data-line-number="7"><span class="co">#&gt;         [0.2269],</span></a>
<a class="sourceLine" id="cb123-8" data-line-number="8"><span class="co">#&gt;         [0.5513],</span></a>
<a class="sourceLine" id="cb123-9" data-line-number="9"><span class="co">#&gt;         [0.7195],</span></a>
<a class="sourceLine" id="cb123-10" data-line-number="10"><span class="co">#&gt;         [0.4231],</span></a>
<a class="sourceLine" id="cb123-11" data-line-number="11"><span class="co">#&gt;         [0.9808],</span></a>
<a class="sourceLine" id="cb123-12" data-line-number="12"><span class="co">#&gt;         [0.6848],</span></a>
<a class="sourceLine" id="cb123-13" data-line-number="13"><span class="co">#&gt;         [0.4809],</span></a>
<a class="sourceLine" id="cb123-14" data-line-number="14"><span class="co">#&gt;         [0.3921],</span></a>
<a class="sourceLine" id="cb123-15" data-line-number="15"><span class="co">#&gt;         [0.3432],</span></a>
<a class="sourceLine" id="cb123-16" data-line-number="16"><span class="co">#&gt;         [0.7290],</span></a>
<a class="sourceLine" id="cb123-17" data-line-number="17"><span class="co">#&gt;         [0.4386],</span></a>
<a class="sourceLine" id="cb123-18" data-line-number="18"><span class="co">#&gt;         [0.0597],</span></a>
<a class="sourceLine" id="cb123-19" data-line-number="19"><span class="co">#&gt;         [0.3980],</span></a>
<a class="sourceLine" id="cb123-20" data-line-number="20"><span class="co">#&gt;         [0.7380],</span></a>
<a class="sourceLine" id="cb123-21" data-line-number="21"><span class="co">#&gt;         [0.1825],</span></a>
<a class="sourceLine" id="cb123-22" data-line-number="22"><span class="co">#&gt;         [0.1755],</span></a>
<a class="sourceLine" id="cb123-23" data-line-number="23"><span class="co">#&gt;         [0.5316],</span></a>
<a class="sourceLine" id="cb123-24" data-line-number="24"><span class="co">#&gt;         [0.5318],</span></a>
<a class="sourceLine" id="cb123-25" data-line-number="25"><span class="co">#&gt;         [0.6344],</span></a>
<a class="sourceLine" id="cb123-26" data-line-number="26"><span class="co">#&gt;         [0.8494],</span></a>
<a class="sourceLine" id="cb123-27" data-line-number="27"><span class="co">#&gt;         [0.7245],</span></a>
<a class="sourceLine" id="cb123-28" data-line-number="28"><span class="co">#&gt;         [0.6110],</span></a>
<a class="sourceLine" id="cb123-29" data-line-number="29"><span class="co">#&gt;         [0.7224],</span></a>
<a class="sourceLine" id="cb123-30" data-line-number="30"><span class="co">#&gt;         [0.3230],</span></a>
<a class="sourceLine" id="cb123-31" data-line-number="31"><span class="co">#&gt;         [0.3618],</span></a>
<a class="sourceLine" id="cb123-32" data-line-number="32"><span class="co">#&gt;         [0.2283],</span></a>
<a class="sourceLine" id="cb123-33" data-line-number="33"><span class="co">#&gt;         [0.2937],</span></a>
<a class="sourceLine" id="cb123-34" data-line-number="34"><span class="co">#&gt;         [0.6310],</span></a>
<a class="sourceLine" id="cb123-35" data-line-number="35"><span class="co">#&gt;         [0.0921],</span></a>
<a class="sourceLine" id="cb123-36" data-line-number="36"><span class="co">#&gt;         [0.4337],</span></a>
<a class="sourceLine" id="cb123-37" data-line-number="37"><span class="co">#&gt;         [0.4309],</span></a>
<a class="sourceLine" id="cb123-38" data-line-number="38"><span class="co">#&gt;         [0.4937],</span></a>
<a class="sourceLine" id="cb123-39" data-line-number="39"><span class="co">#&gt;         [0.4258],</span></a>
<a class="sourceLine" id="cb123-40" data-line-number="40"><span class="co">#&gt;         [0.3123],</span></a>
<a class="sourceLine" id="cb123-41" data-line-number="41"><span class="co">#&gt;         [0.4264],</span></a>
<a class="sourceLine" id="cb123-42" data-line-number="42"><span class="co">#&gt;         [0.8934],</span></a>
<a class="sourceLine" id="cb123-43" data-line-number="43"><span class="co">#&gt;         [0.9442],</span></a>
<a class="sourceLine" id="cb123-44" data-line-number="44"><span class="co">#&gt;         [0.5018],</span></a>
<a class="sourceLine" id="cb123-45" data-line-number="45"><span class="co">#&gt;         [0.6240],</span></a>
<a class="sourceLine" id="cb123-46" data-line-number="46"><span class="co">#&gt;         [0.1156],</span></a>
<a class="sourceLine" id="cb123-47" data-line-number="47"><span class="co">#&gt;         [0.3173],</span></a>
<a class="sourceLine" id="cb123-48" data-line-number="48"><span class="co">#&gt;         [0.4148],</span></a>
<a class="sourceLine" id="cb123-49" data-line-number="49"><span class="co">#&gt;         [0.8663],</span></a>
<a class="sourceLine" id="cb123-50" data-line-number="50"><span class="co">#&gt;         [0.2505],</span></a>
<a class="sourceLine" id="cb123-51" data-line-number="51"><span class="co">#&gt;         [0.4830],</span></a>
<a class="sourceLine" id="cb123-52" data-line-number="52"><span class="co">#&gt;         [0.9856],</span></a>
<a class="sourceLine" id="cb123-53" data-line-number="53"><span class="co">#&gt;         [0.5195],</span></a>
<a class="sourceLine" id="cb123-54" data-line-number="54"><span class="co">#&gt;         [0.6129],</span></a>
<a class="sourceLine" id="cb123-55" data-line-number="55"><span class="co">#&gt;         [0.1206],</span></a>
<a class="sourceLine" id="cb123-56" data-line-number="56"><span class="co">#&gt;         [0.8263],</span></a>
<a class="sourceLine" id="cb123-57" data-line-number="57"><span class="co">#&gt;         [0.6031],</span></a>
<a class="sourceLine" id="cb123-58" data-line-number="58"><span class="co">#&gt;         [0.5451],</span></a>
<a class="sourceLine" id="cb123-59" data-line-number="59"><span class="co">#&gt;         [0.3428],</span></a>
<a class="sourceLine" id="cb123-60" data-line-number="60"><span class="co">#&gt;         [0.3041],</span></a>
<a class="sourceLine" id="cb123-61" data-line-number="61"><span class="co">#&gt;         [0.4170],</span></a>
<a class="sourceLine" id="cb123-62" data-line-number="62"><span class="co">#&gt;         [0.6813],</span></a>
<a class="sourceLine" id="cb123-63" data-line-number="63"><span class="co">#&gt;         [0.8755],</span></a>
<a class="sourceLine" id="cb123-64" data-line-number="64"><span class="co">#&gt;         [0.5104],</span></a>
<a class="sourceLine" id="cb123-65" data-line-number="65"><span class="co">#&gt;         [0.6693],</span></a>
<a class="sourceLine" id="cb123-66" data-line-number="66"><span class="co">#&gt;         [0.5859],</span></a>
<a class="sourceLine" id="cb123-67" data-line-number="67"><span class="co">#&gt;         [0.6249],</span></a>
<a class="sourceLine" id="cb123-68" data-line-number="68"><span class="co">#&gt;         [0.6747],</span></a>
<a class="sourceLine" id="cb123-69" data-line-number="69"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb123-70" data-line-number="70"><span class="co">#&gt;         [0.0832],</span></a>
<a class="sourceLine" id="cb123-71" data-line-number="71"><span class="co">#&gt;         [0.7637],</span></a>
<a class="sourceLine" id="cb123-72" data-line-number="72"><span class="co">#&gt;         [0.2437],</span></a>
<a class="sourceLine" id="cb123-73" data-line-number="73"><span class="co">#&gt;         [0.1942],</span></a>
<a class="sourceLine" id="cb123-74" data-line-number="74"><span class="co">#&gt;         [0.5725],</span></a>
<a class="sourceLine" id="cb123-75" data-line-number="75"><span class="co">#&gt;         [0.0957],</span></a>
<a class="sourceLine" id="cb123-76" data-line-number="76"><span class="co">#&gt;         [0.8853],</span></a>
<a class="sourceLine" id="cb123-77" data-line-number="77"><span class="co">#&gt;         [0.6272],</span></a>
<a class="sourceLine" id="cb123-78" data-line-number="78"><span class="co">#&gt;         [0.7234],</span></a>
<a class="sourceLine" id="cb123-79" data-line-number="79"><span class="co">#&gt;         [0.0161],</span></a>
<a class="sourceLine" id="cb123-80" data-line-number="80"><span class="co">#&gt;         [0.5944],</span></a>
<a class="sourceLine" id="cb123-81" data-line-number="81"><span class="co">#&gt;         [0.5568],</span></a>
<a class="sourceLine" id="cb123-82" data-line-number="82"><span class="co">#&gt;         [0.1590],</span></a>
<a class="sourceLine" id="cb123-83" data-line-number="83"><span class="co">#&gt;         [0.1531],</span></a>
<a class="sourceLine" id="cb123-84" data-line-number="84"><span class="co">#&gt;         [0.6955],</span></a>
<a class="sourceLine" id="cb123-85" data-line-number="85"><span class="co">#&gt;         [0.3188],</span></a>
<a class="sourceLine" id="cb123-86" data-line-number="86"><span class="co">#&gt;         [0.6920],</span></a>
<a class="sourceLine" id="cb123-87" data-line-number="87"><span class="co">#&gt;         [0.5544],</span></a>
<a class="sourceLine" id="cb123-88" data-line-number="88"><span class="co">#&gt;         [0.3890],</span></a>
<a class="sourceLine" id="cb123-89" data-line-number="89"><span class="co">#&gt;         [0.9251],</span></a>
<a class="sourceLine" id="cb123-90" data-line-number="90"><span class="co">#&gt;         [0.8417],</span></a>
<a class="sourceLine" id="cb123-91" data-line-number="91"><span class="co">#&gt;         [0.3574],</span></a>
<a class="sourceLine" id="cb123-92" data-line-number="92"><span class="co">#&gt;         [0.0436],</span></a>
<a class="sourceLine" id="cb123-93" data-line-number="93"><span class="co">#&gt;         [0.3048],</span></a>
<a class="sourceLine" id="cb123-94" data-line-number="94"><span class="co">#&gt;         [0.3982],</span></a>
<a class="sourceLine" id="cb123-95" data-line-number="95"><span class="co">#&gt;         [0.7050],</span></a>
<a class="sourceLine" id="cb123-96" data-line-number="96"><span class="co">#&gt;         [0.9954],</span></a>
<a class="sourceLine" id="cb123-97" data-line-number="97"><span class="co">#&gt;         [0.3559],</span></a>
<a class="sourceLine" id="cb123-98" data-line-number="98"><span class="co">#&gt;         [0.7625],</span></a>
<a class="sourceLine" id="cb123-99" data-line-number="99"><span class="co">#&gt;         [0.5932],</span></a>
<a class="sourceLine" id="cb123-100" data-line-number="100"><span class="co">#&gt;         [0.6917],</span></a>
<a class="sourceLine" id="cb123-101" data-line-number="101"><span class="co">#&gt;         [0.1511],</span></a>
<a class="sourceLine" id="cb123-102" data-line-number="102"><span class="co">#&gt;         [0.3989],</span></a>
<a class="sourceLine" id="cb123-103" data-line-number="103"><span class="co">#&gt;         [0.2409],</span></a>
<a class="sourceLine" id="cb123-104" data-line-number="104"><span class="co">#&gt;         [0.3435]]) tensor([[2.7166],</span></a>
<a class="sourceLine" id="cb123-105" data-line-number="105"><span class="co">#&gt;         [1.3983],</span></a>
<a class="sourceLine" id="cb123-106" data-line-number="106"><span class="co">#&gt;         [0.7679],</span></a>
<a class="sourceLine" id="cb123-107" data-line-number="107"><span class="co">#&gt;         [1.8464],</span></a>
<a class="sourceLine" id="cb123-108" data-line-number="108"><span class="co">#&gt;         [2.6614],</span></a>
<a class="sourceLine" id="cb123-109" data-line-number="109"><span class="co">#&gt;         [1.8297],</span></a>
<a class="sourceLine" id="cb123-110" data-line-number="110"><span class="co">#&gt;         [4.4034],</span></a>
<a class="sourceLine" id="cb123-111" data-line-number="111"><span class="co">#&gt;         [2.7003],</span></a>
<a class="sourceLine" id="cb123-112" data-line-number="112"><span class="co">#&gt;         [2.1778],</span></a>
<a class="sourceLine" id="cb123-113" data-line-number="113"><span class="co">#&gt;         [1.5073],</span></a>
<a class="sourceLine" id="cb123-114" data-line-number="114"><span class="co">#&gt;         [1.2966],</span></a>
<a class="sourceLine" id="cb123-115" data-line-number="115"><span class="co">#&gt;         [2.7287],</span></a>
<a class="sourceLine" id="cb123-116" data-line-number="116"><span class="co">#&gt;         [1.4884],</span></a>
<a class="sourceLine" id="cb123-117" data-line-number="117"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb123-118" data-line-number="118"><span class="co">#&gt;         [1.4895],</span></a>
<a class="sourceLine" id="cb123-119" data-line-number="119"><span class="co">#&gt;         [2.9263],</span></a>
<a class="sourceLine" id="cb123-120" data-line-number="120"><span class="co">#&gt;         [1.0114],</span></a>
<a class="sourceLine" id="cb123-121" data-line-number="121"><span class="co">#&gt;         [0.9445],</span></a>
<a class="sourceLine" id="cb123-122" data-line-number="122"><span class="co">#&gt;         [1.6729],</span></a>
<a class="sourceLine" id="cb123-123" data-line-number="123"><span class="co">#&gt;         [2.4624],</span></a>
<a class="sourceLine" id="cb123-124" data-line-number="124"><span class="co">#&gt;         [2.7788],</span></a>
<a class="sourceLine" id="cb123-125" data-line-number="125"><span class="co">#&gt;         [3.1746],</span></a>
<a class="sourceLine" id="cb123-126" data-line-number="126"><span class="co">#&gt;         [2.6593],</span></a>
<a class="sourceLine" id="cb123-127" data-line-number="127"><span class="co">#&gt;         [2.3800],</span></a>
<a class="sourceLine" id="cb123-128" data-line-number="128"><span class="co">#&gt;         [3.1382],</span></a>
<a class="sourceLine" id="cb123-129" data-line-number="129"><span class="co">#&gt;         [1.7665],</span></a>
<a class="sourceLine" id="cb123-130" data-line-number="130"><span class="co">#&gt;         [1.3082],</span></a>
<a class="sourceLine" id="cb123-131" data-line-number="131"><span class="co">#&gt;         [1.1390],</span></a>
<a class="sourceLine" id="cb123-132" data-line-number="132"><span class="co">#&gt;         [1.5341],</span></a>
<a class="sourceLine" id="cb123-133" data-line-number="133"><span class="co">#&gt;         [2.3566],</span></a>
<a class="sourceLine" id="cb123-134" data-line-number="134"><span class="co">#&gt;         [0.8612],</span></a>
<a class="sourceLine" id="cb123-135" data-line-number="135"><span class="co">#&gt;         [1.4642],</span></a>
<a class="sourceLine" id="cb123-136" data-line-number="136"><span class="co">#&gt;         [1.8066],</span></a>
<a class="sourceLine" id="cb123-137" data-line-number="137"><span class="co">#&gt;         [2.2308],</span></a>
<a class="sourceLine" id="cb123-138" data-line-number="138"><span class="co">#&gt;         [2.0962],</span></a>
<a class="sourceLine" id="cb123-139" data-line-number="139"><span class="co">#&gt;         [1.0096],</span></a>
<a class="sourceLine" id="cb123-140" data-line-number="140"><span class="co">#&gt;         [1.6538],</span></a>
<a class="sourceLine" id="cb123-141" data-line-number="141"><span class="co">#&gt;         [3.3994],</span></a>
<a class="sourceLine" id="cb123-142" data-line-number="142"><span class="co">#&gt;         [3.8747],</span></a>
<a class="sourceLine" id="cb123-143" data-line-number="143"><span class="co">#&gt;         [2.0045],</span></a>
<a class="sourceLine" id="cb123-144" data-line-number="144"><span class="co">#&gt;         [2.0884],</span></a>
<a class="sourceLine" id="cb123-145" data-line-number="145"><span class="co">#&gt;         [0.5845],</span></a>
<a class="sourceLine" id="cb123-146" data-line-number="146"><span class="co">#&gt;         [1.7039],</span></a>
<a class="sourceLine" id="cb123-147" data-line-number="147"><span class="co">#&gt;         [1.7285],</span></a>
<a class="sourceLine" id="cb123-148" data-line-number="148"><span class="co">#&gt;         [3.4602],</span></a>
<a class="sourceLine" id="cb123-149" data-line-number="149"><span class="co">#&gt;         [1.3581],</span></a>
<a class="sourceLine" id="cb123-150" data-line-number="150"><span class="co">#&gt;         [2.0949],</span></a>
<a class="sourceLine" id="cb123-151" data-line-number="151"><span class="co">#&gt;         [3.7935],</span></a>
<a class="sourceLine" id="cb123-152" data-line-number="152"><span class="co">#&gt;         [2.1950],</span></a>
<a class="sourceLine" id="cb123-153" data-line-number="153"><span class="co">#&gt;         [2.6425],</span></a>
<a class="sourceLine" id="cb123-154" data-line-number="154"><span class="co">#&gt;         [0.4948],</span></a>
<a class="sourceLine" id="cb123-155" data-line-number="155"><span class="co">#&gt;         [3.5188],</span></a>
<a class="sourceLine" id="cb123-156" data-line-number="156"><span class="co">#&gt;         [2.1628],</span></a>
<a class="sourceLine" id="cb123-157" data-line-number="157"><span class="co">#&gt;         [1.9643],</span></a>
<a class="sourceLine" id="cb123-158" data-line-number="158"><span class="co">#&gt;         [1.5740],</span></a>
<a class="sourceLine" id="cb123-159" data-line-number="159"><span class="co">#&gt;         [1.0099],</span></a>
<a class="sourceLine" id="cb123-160" data-line-number="160"><span class="co">#&gt;         [1.8123],</span></a>
<a class="sourceLine" id="cb123-161" data-line-number="161"><span class="co">#&gt;         [2.9534],</span></a>
<a class="sourceLine" id="cb123-162" data-line-number="162"><span class="co">#&gt;         [3.6986],</span></a>
<a class="sourceLine" id="cb123-163" data-line-number="163"><span class="co">#&gt;         [1.9485],</span></a>
<a class="sourceLine" id="cb123-164" data-line-number="164"><span class="co">#&gt;         [2.5445],</span></a>
<a class="sourceLine" id="cb123-165" data-line-number="165"><span class="co">#&gt;         [2.4811],</span></a>
<a class="sourceLine" id="cb123-166" data-line-number="166"><span class="co">#&gt;         [2.4700],</span></a>
<a class="sourceLine" id="cb123-167" data-line-number="167"><span class="co">#&gt;         [2.2838],</span></a>
<a class="sourceLine" id="cb123-168" data-line-number="168"><span class="co">#&gt;         [3.4392],</span></a>
<a class="sourceLine" id="cb123-169" data-line-number="169"><span class="co">#&gt;         [0.9015],</span></a>
<a class="sourceLine" id="cb123-170" data-line-number="170"><span class="co">#&gt;         [2.8687],</span></a>
<a class="sourceLine" id="cb123-171" data-line-number="171"><span class="co">#&gt;         [1.4766],</span></a>
<a class="sourceLine" id="cb123-172" data-line-number="172"><span class="co">#&gt;         [1.1847],</span></a>
<a class="sourceLine" id="cb123-173" data-line-number="173"><span class="co">#&gt;         [2.2782],</span></a>
<a class="sourceLine" id="cb123-174" data-line-number="174"><span class="co">#&gt;         [0.8885],</span></a>
<a class="sourceLine" id="cb123-175" data-line-number="175"><span class="co">#&gt;         [3.2565],</span></a>
<a class="sourceLine" id="cb123-176" data-line-number="176"><span class="co">#&gt;         [2.7141],</span></a>
<a class="sourceLine" id="cb123-177" data-line-number="177"><span class="co">#&gt;         [3.0781],</span></a>
<a class="sourceLine" id="cb123-178" data-line-number="178"><span class="co">#&gt;         [0.7763],</span></a>
<a class="sourceLine" id="cb123-179" data-line-number="179"><span class="co">#&gt;         [2.0038],</span></a>
<a class="sourceLine" id="cb123-180" data-line-number="180"><span class="co">#&gt;         [1.8270],</span></a>
<a class="sourceLine" id="cb123-181" data-line-number="181"><span class="co">#&gt;         [0.5882],</span></a>
<a class="sourceLine" id="cb123-182" data-line-number="182"><span class="co">#&gt;         [0.7793],</span></a>
<a class="sourceLine" id="cb123-183" data-line-number="183"><span class="co">#&gt;         [2.6416],</span></a>
<a class="sourceLine" id="cb123-184" data-line-number="184"><span class="co">#&gt;         [1.4162],</span></a>
<a class="sourceLine" id="cb123-185" data-line-number="185"><span class="co">#&gt;         [2.3851],</span></a>
<a class="sourceLine" id="cb123-186" data-line-number="186"><span class="co">#&gt;         [1.9140],</span></a>
<a class="sourceLine" id="cb123-187" data-line-number="187"><span class="co">#&gt;         [1.8385],</span></a>
<a class="sourceLine" id="cb123-188" data-line-number="188"><span class="co">#&gt;         [3.7822],</span></a>
<a class="sourceLine" id="cb123-189" data-line-number="189"><span class="co">#&gt;         [3.6160],</span></a>
<a class="sourceLine" id="cb123-190" data-line-number="190"><span class="co">#&gt;         [1.0941],</span></a>
<a class="sourceLine" id="cb123-191" data-line-number="191"><span class="co">#&gt;         [0.5721],</span></a>
<a class="sourceLine" id="cb123-192" data-line-number="192"><span class="co">#&gt;         [1.6683],</span></a>
<a class="sourceLine" id="cb123-193" data-line-number="193"><span class="co">#&gt;         [1.6848],</span></a>
<a class="sourceLine" id="cb123-194" data-line-number="194"><span class="co">#&gt;         [2.5068],</span></a>
<a class="sourceLine" id="cb123-195" data-line-number="195"><span class="co">#&gt;         [4.3876],</span></a>
<a class="sourceLine" id="cb123-196" data-line-number="196"><span class="co">#&gt;         [1.3866],</span></a>
<a class="sourceLine" id="cb123-197" data-line-number="197"><span class="co">#&gt;         [3.1286],</span></a>
<a class="sourceLine" id="cb123-198" data-line-number="198"><span class="co">#&gt;         [1.9197],</span></a>
<a class="sourceLine" id="cb123-199" data-line-number="199"><span class="co">#&gt;         [2.7949],</span></a>
<a class="sourceLine" id="cb123-200" data-line-number="200"><span class="co">#&gt;         [0.4797],</span></a>
<a class="sourceLine" id="cb123-201" data-line-number="201"><span class="co">#&gt;         [1.8171],</span></a>
<a class="sourceLine" id="cb123-202" data-line-number="202"><span class="co">#&gt;         [1.1042],</span></a>
<a class="sourceLine" id="cb123-203" data-line-number="203"><span class="co">#&gt;         [1.1414]])</span></a></code></pre></div>
<div id="code-in-r-1" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Code in R</h3>
<p>Notice that before converting to a Torch tensor, we need first to convert the R numeric vector to a <code>numpy</code> array:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="co"># convert numpy array to tensor in shape of input size</span></a>
<a class="sourceLine" id="cb124-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">r_to_py</span>(x)</a>
<a class="sourceLine" id="cb124-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw">r_to_py</span>(y)</a>
<a class="sourceLine" id="cb124-4" data-line-number="4">x =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(x<span class="op">$</span><span class="kw">reshape</span>(<span class="op">-</span>1L, 1L)) <span class="co">#$float()</span></a>
<a class="sourceLine" id="cb124-5" data-line-number="5">y =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(y<span class="op">$</span><span class="kw">reshape</span>(<span class="op">-</span>1L, 1L)) <span class="co">#$float()</span></a>
<a class="sourceLine" id="cb124-6" data-line-number="6"><span class="kw">print</span>(x, y)</a>
<a class="sourceLine" id="cb124-7" data-line-number="7"><span class="co">#&gt; tensor([[0.6965],</span></a>
<a class="sourceLine" id="cb124-8" data-line-number="8"><span class="co">#&gt;         [0.2861],</span></a>
<a class="sourceLine" id="cb124-9" data-line-number="9"><span class="co">#&gt;         [0.2269],</span></a>
<a class="sourceLine" id="cb124-10" data-line-number="10"><span class="co">#&gt;         [0.5513],</span></a>
<a class="sourceLine" id="cb124-11" data-line-number="11"><span class="co">#&gt;         [0.7195],</span></a>
<a class="sourceLine" id="cb124-12" data-line-number="12"><span class="co">#&gt;         [0.4231],</span></a>
<a class="sourceLine" id="cb124-13" data-line-number="13"><span class="co">#&gt;         [0.9808],</span></a>
<a class="sourceLine" id="cb124-14" data-line-number="14"><span class="co">#&gt;         [0.6848],</span></a>
<a class="sourceLine" id="cb124-15" data-line-number="15"><span class="co">#&gt;         [0.4809],</span></a>
<a class="sourceLine" id="cb124-16" data-line-number="16"><span class="co">#&gt;         [0.3921],</span></a>
<a class="sourceLine" id="cb124-17" data-line-number="17"><span class="co">#&gt;         [0.3432],</span></a>
<a class="sourceLine" id="cb124-18" data-line-number="18"><span class="co">#&gt;         [0.7290],</span></a>
<a class="sourceLine" id="cb124-19" data-line-number="19"><span class="co">#&gt;         [0.4386],</span></a>
<a class="sourceLine" id="cb124-20" data-line-number="20"><span class="co">#&gt;         [0.0597],</span></a>
<a class="sourceLine" id="cb124-21" data-line-number="21"><span class="co">#&gt;         [0.3980],</span></a>
<a class="sourceLine" id="cb124-22" data-line-number="22"><span class="co">#&gt;         [0.7380],</span></a>
<a class="sourceLine" id="cb124-23" data-line-number="23"><span class="co">#&gt;         [0.1825],</span></a>
<a class="sourceLine" id="cb124-24" data-line-number="24"><span class="co">#&gt;         [0.1755],</span></a>
<a class="sourceLine" id="cb124-25" data-line-number="25"><span class="co">#&gt;         [0.5316],</span></a>
<a class="sourceLine" id="cb124-26" data-line-number="26"><span class="co">#&gt;         [0.5318],</span></a>
<a class="sourceLine" id="cb124-27" data-line-number="27"><span class="co">#&gt;         [0.6344],</span></a>
<a class="sourceLine" id="cb124-28" data-line-number="28"><span class="co">#&gt;         [0.8494],</span></a>
<a class="sourceLine" id="cb124-29" data-line-number="29"><span class="co">#&gt;         [0.7245],</span></a>
<a class="sourceLine" id="cb124-30" data-line-number="30"><span class="co">#&gt;         [0.6110],</span></a>
<a class="sourceLine" id="cb124-31" data-line-number="31"><span class="co">#&gt;         [0.7224],</span></a>
<a class="sourceLine" id="cb124-32" data-line-number="32"><span class="co">#&gt;         [0.3230],</span></a>
<a class="sourceLine" id="cb124-33" data-line-number="33"><span class="co">#&gt;         [0.3618],</span></a>
<a class="sourceLine" id="cb124-34" data-line-number="34"><span class="co">#&gt;         [0.2283],</span></a>
<a class="sourceLine" id="cb124-35" data-line-number="35"><span class="co">#&gt;         [0.2937],</span></a>
<a class="sourceLine" id="cb124-36" data-line-number="36"><span class="co">#&gt;         [0.6310],</span></a>
<a class="sourceLine" id="cb124-37" data-line-number="37"><span class="co">#&gt;         [0.0921],</span></a>
<a class="sourceLine" id="cb124-38" data-line-number="38"><span class="co">#&gt;         [0.4337],</span></a>
<a class="sourceLine" id="cb124-39" data-line-number="39"><span class="co">#&gt;         [0.4309],</span></a>
<a class="sourceLine" id="cb124-40" data-line-number="40"><span class="co">#&gt;         [0.4937],</span></a>
<a class="sourceLine" id="cb124-41" data-line-number="41"><span class="co">#&gt;         [0.4258],</span></a>
<a class="sourceLine" id="cb124-42" data-line-number="42"><span class="co">#&gt;         [0.3123],</span></a>
<a class="sourceLine" id="cb124-43" data-line-number="43"><span class="co">#&gt;         [0.4264],</span></a>
<a class="sourceLine" id="cb124-44" data-line-number="44"><span class="co">#&gt;         [0.8934],</span></a>
<a class="sourceLine" id="cb124-45" data-line-number="45"><span class="co">#&gt;         [0.9442],</span></a>
<a class="sourceLine" id="cb124-46" data-line-number="46"><span class="co">#&gt;         [0.5018],</span></a>
<a class="sourceLine" id="cb124-47" data-line-number="47"><span class="co">#&gt;         [0.6240],</span></a>
<a class="sourceLine" id="cb124-48" data-line-number="48"><span class="co">#&gt;         [0.1156],</span></a>
<a class="sourceLine" id="cb124-49" data-line-number="49"><span class="co">#&gt;         [0.3173],</span></a>
<a class="sourceLine" id="cb124-50" data-line-number="50"><span class="co">#&gt;         [0.4148],</span></a>
<a class="sourceLine" id="cb124-51" data-line-number="51"><span class="co">#&gt;         [0.8663],</span></a>
<a class="sourceLine" id="cb124-52" data-line-number="52"><span class="co">#&gt;         [0.2505],</span></a>
<a class="sourceLine" id="cb124-53" data-line-number="53"><span class="co">#&gt;         [0.4830],</span></a>
<a class="sourceLine" id="cb124-54" data-line-number="54"><span class="co">#&gt;         [0.9856],</span></a>
<a class="sourceLine" id="cb124-55" data-line-number="55"><span class="co">#&gt;         [0.5195],</span></a>
<a class="sourceLine" id="cb124-56" data-line-number="56"><span class="co">#&gt;         [0.6129],</span></a>
<a class="sourceLine" id="cb124-57" data-line-number="57"><span class="co">#&gt;         [0.1206],</span></a>
<a class="sourceLine" id="cb124-58" data-line-number="58"><span class="co">#&gt;         [0.8263],</span></a>
<a class="sourceLine" id="cb124-59" data-line-number="59"><span class="co">#&gt;         [0.6031],</span></a>
<a class="sourceLine" id="cb124-60" data-line-number="60"><span class="co">#&gt;         [0.5451],</span></a>
<a class="sourceLine" id="cb124-61" data-line-number="61"><span class="co">#&gt;         [0.3428],</span></a>
<a class="sourceLine" id="cb124-62" data-line-number="62"><span class="co">#&gt;         [0.3041],</span></a>
<a class="sourceLine" id="cb124-63" data-line-number="63"><span class="co">#&gt;         [0.4170],</span></a>
<a class="sourceLine" id="cb124-64" data-line-number="64"><span class="co">#&gt;         [0.6813],</span></a>
<a class="sourceLine" id="cb124-65" data-line-number="65"><span class="co">#&gt;         [0.8755],</span></a>
<a class="sourceLine" id="cb124-66" data-line-number="66"><span class="co">#&gt;         [0.5104],</span></a>
<a class="sourceLine" id="cb124-67" data-line-number="67"><span class="co">#&gt;         [0.6693],</span></a>
<a class="sourceLine" id="cb124-68" data-line-number="68"><span class="co">#&gt;         [0.5859],</span></a>
<a class="sourceLine" id="cb124-69" data-line-number="69"><span class="co">#&gt;         [0.6249],</span></a>
<a class="sourceLine" id="cb124-70" data-line-number="70"><span class="co">#&gt;         [0.6747],</span></a>
<a class="sourceLine" id="cb124-71" data-line-number="71"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb124-72" data-line-number="72"><span class="co">#&gt;         [0.0832],</span></a>
<a class="sourceLine" id="cb124-73" data-line-number="73"><span class="co">#&gt;         [0.7637],</span></a>
<a class="sourceLine" id="cb124-74" data-line-number="74"><span class="co">#&gt;         [0.2437],</span></a>
<a class="sourceLine" id="cb124-75" data-line-number="75"><span class="co">#&gt;         [0.1942],</span></a>
<a class="sourceLine" id="cb124-76" data-line-number="76"><span class="co">#&gt;         [0.5725],</span></a>
<a class="sourceLine" id="cb124-77" data-line-number="77"><span class="co">#&gt;         [0.0957],</span></a>
<a class="sourceLine" id="cb124-78" data-line-number="78"><span class="co">#&gt;         [0.8853],</span></a>
<a class="sourceLine" id="cb124-79" data-line-number="79"><span class="co">#&gt;         [0.6272],</span></a>
<a class="sourceLine" id="cb124-80" data-line-number="80"><span class="co">#&gt;         [0.7234],</span></a>
<a class="sourceLine" id="cb124-81" data-line-number="81"><span class="co">#&gt;         [0.0161],</span></a>
<a class="sourceLine" id="cb124-82" data-line-number="82"><span class="co">#&gt;         [0.5944],</span></a>
<a class="sourceLine" id="cb124-83" data-line-number="83"><span class="co">#&gt;         [0.5568],</span></a>
<a class="sourceLine" id="cb124-84" data-line-number="84"><span class="co">#&gt;         [0.1590],</span></a>
<a class="sourceLine" id="cb124-85" data-line-number="85"><span class="co">#&gt;         [0.1531],</span></a>
<a class="sourceLine" id="cb124-86" data-line-number="86"><span class="co">#&gt;         [0.6955],</span></a>
<a class="sourceLine" id="cb124-87" data-line-number="87"><span class="co">#&gt;         [0.3188],</span></a>
<a class="sourceLine" id="cb124-88" data-line-number="88"><span class="co">#&gt;         [0.6920],</span></a>
<a class="sourceLine" id="cb124-89" data-line-number="89"><span class="co">#&gt;         [0.5544],</span></a>
<a class="sourceLine" id="cb124-90" data-line-number="90"><span class="co">#&gt;         [0.3890],</span></a>
<a class="sourceLine" id="cb124-91" data-line-number="91"><span class="co">#&gt;         [0.9251],</span></a>
<a class="sourceLine" id="cb124-92" data-line-number="92"><span class="co">#&gt;         [0.8417],</span></a>
<a class="sourceLine" id="cb124-93" data-line-number="93"><span class="co">#&gt;         [0.3574],</span></a>
<a class="sourceLine" id="cb124-94" data-line-number="94"><span class="co">#&gt;         [0.0436],</span></a>
<a class="sourceLine" id="cb124-95" data-line-number="95"><span class="co">#&gt;         [0.3048],</span></a>
<a class="sourceLine" id="cb124-96" data-line-number="96"><span class="co">#&gt;         [0.3982],</span></a>
<a class="sourceLine" id="cb124-97" data-line-number="97"><span class="co">#&gt;         [0.7050],</span></a>
<a class="sourceLine" id="cb124-98" data-line-number="98"><span class="co">#&gt;         [0.9954],</span></a>
<a class="sourceLine" id="cb124-99" data-line-number="99"><span class="co">#&gt;         [0.3559],</span></a>
<a class="sourceLine" id="cb124-100" data-line-number="100"><span class="co">#&gt;         [0.7625],</span></a>
<a class="sourceLine" id="cb124-101" data-line-number="101"><span class="co">#&gt;         [0.5932],</span></a>
<a class="sourceLine" id="cb124-102" data-line-number="102"><span class="co">#&gt;         [0.6917],</span></a>
<a class="sourceLine" id="cb124-103" data-line-number="103"><span class="co">#&gt;         [0.1511],</span></a>
<a class="sourceLine" id="cb124-104" data-line-number="104"><span class="co">#&gt;         [0.3989],</span></a>
<a class="sourceLine" id="cb124-105" data-line-number="105"><span class="co">#&gt;         [0.2409],</span></a>
<a class="sourceLine" id="cb124-106" data-line-number="106"><span class="co">#&gt;         [0.3435]], dtype=torch.float64)</span></a></code></pre></div>
</div>
</div>
<div id="optimizer-and-loss-1" class="section level2">
<h2><span class="header-section-number">10.3</span> Optimizer and Loss</h2>
<p>Next, you should define the Optimizer and the Loss Function for our training process.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="co"># Define Optimizer and Loss Function</span></a>
<a class="sourceLine" id="cb125-2" data-line-number="2">optimizer <span class="op">=</span> torch.optim.SGD(net.parameters(), lr<span class="op">=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb125-3" data-line-number="3">loss_func <span class="op">=</span> torch.nn.MSELoss()</a>
<a class="sourceLine" id="cb125-4" data-line-number="4"><span class="bu">print</span>(optimizer)</a>
<a class="sourceLine" id="cb125-5" data-line-number="5"><span class="co">#&gt; SGD (</span></a>
<a class="sourceLine" id="cb125-6" data-line-number="6"><span class="co">#&gt; Parameter Group 0</span></a>
<a class="sourceLine" id="cb125-7" data-line-number="7"><span class="co">#&gt;     dampening: 0</span></a>
<a class="sourceLine" id="cb125-8" data-line-number="8"><span class="co">#&gt;     lr: 0.2</span></a>
<a class="sourceLine" id="cb125-9" data-line-number="9"><span class="co">#&gt;     momentum: 0</span></a>
<a class="sourceLine" id="cb125-10" data-line-number="10"><span class="co">#&gt;     nesterov: False</span></a>
<a class="sourceLine" id="cb125-11" data-line-number="11"><span class="co">#&gt;     weight_decay: 0</span></a>
<a class="sourceLine" id="cb125-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb125-13" data-line-number="13"><span class="bu">print</span>(loss_func)</a>
<a class="sourceLine" id="cb125-14" data-line-number="14"><span class="co">#&gt; MSELoss()</span></a></code></pre></div>
<div id="equivalent-code-in-r" class="section level3">
<h3><span class="header-section-number">10.3.1</span> Equivalent code in R</h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="co"># Define Optimizer and Loss Function</span></a>
<a class="sourceLine" id="cb126-2" data-line-number="2">optimizer &lt;-<span class="st"> </span>torch<span class="op">$</span>optim<span class="op">$</span><span class="kw">SGD</span>(net<span class="op">$</span><span class="kw">parameters</span>(), <span class="dt">lr=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb126-3" data-line-number="3">loss_func &lt;-<span class="st"> </span>torch<span class="op">$</span>nn<span class="op">$</span><span class="kw">MSELoss</span>()</a>
<a class="sourceLine" id="cb126-4" data-line-number="4"><span class="kw">print</span>(optimizer)</a>
<a class="sourceLine" id="cb126-5" data-line-number="5"><span class="co">#&gt; SGD (</span></a>
<a class="sourceLine" id="cb126-6" data-line-number="6"><span class="co">#&gt; Parameter Group 0</span></a>
<a class="sourceLine" id="cb126-7" data-line-number="7"><span class="co">#&gt;     dampening: 0</span></a>
<a class="sourceLine" id="cb126-8" data-line-number="8"><span class="co">#&gt;     lr: 0.2</span></a>
<a class="sourceLine" id="cb126-9" data-line-number="9"><span class="co">#&gt;     momentum: 0</span></a>
<a class="sourceLine" id="cb126-10" data-line-number="10"><span class="co">#&gt;     nesterov: False</span></a>
<a class="sourceLine" id="cb126-11" data-line-number="11"><span class="co">#&gt;     weight_decay: 0</span></a>
<a class="sourceLine" id="cb126-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb126-13" data-line-number="13"><span class="kw">print</span>(loss_func)</a>
<a class="sourceLine" id="cb126-14" data-line-number="14"><span class="co">#&gt; MSELoss()</span></a></code></pre></div>
</div>
</div>
<div id="training-2" class="section level2">
<h2><span class="header-section-number">10.4</span> Training</h2>
<div id="code-in-python" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Code in Python</h3>
<p>Now let’s start our training process. With an epoch of 250, you will iterate our data to find the best value for our hyperparameters.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb127-1" data-line-number="1">inputs <span class="op">=</span> Variable(x)</a>
<a class="sourceLine" id="cb127-2" data-line-number="2">outputs <span class="op">=</span> Variable(y)</a>
<a class="sourceLine" id="cb127-3" data-line-number="3"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">250</span>):</a>
<a class="sourceLine" id="cb127-4" data-line-number="4">   prediction <span class="op">=</span> net(inputs)</a>
<a class="sourceLine" id="cb127-5" data-line-number="5">   loss <span class="op">=</span> loss_func(prediction, outputs) </a>
<a class="sourceLine" id="cb127-6" data-line-number="6">   optimizer.zero_grad()</a>
<a class="sourceLine" id="cb127-7" data-line-number="7">   loss.backward()        </a>
<a class="sourceLine" id="cb127-8" data-line-number="8">   optimizer.step()       </a>
<a class="sourceLine" id="cb127-9" data-line-number="9"></a>
<a class="sourceLine" id="cb127-10" data-line-number="10">   <span class="cf">if</span> i <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb127-11" data-line-number="11">       <span class="co"># plot and show learning process</span></a>
<a class="sourceLine" id="cb127-12" data-line-number="12">       plt.cla()</a>
<a class="sourceLine" id="cb127-13" data-line-number="13">       plt.scatter(x.data.numpy(), y.data.numpy())</a>
<a class="sourceLine" id="cb127-14" data-line-number="14">       plt.plot(x.data.numpy(), prediction.data.numpy(), <span class="st">&#39;r-&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb127-15" data-line-number="15">       plt.text(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="st">&#39;Loss=</span><span class="sc">%.4f</span><span class="st">&#39;</span> <span class="op">%</span> loss.data.numpy(), fontdict<span class="op">=</span>{<span class="st">&#39;size&#39;</span>: <span class="dv">10</span>, <span class="st">&#39;color&#39;</span>:  <span class="st">&#39;red&#39;</span>})</a>
<a class="sourceLine" id="cb127-16" data-line-number="16">       plt.pause(<span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-2.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-3.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-4.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-5.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-6.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-7.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-8.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-9.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-10.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-11.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-12.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-13.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-14.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-15.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-16.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-17.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-18.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-19.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-20.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-21.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-22.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-23.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-24.png" width="70%" style="display: block; margin: auto;" /><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-25.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb128-1" data-line-number="1">plt.show()</a></code></pre></div>
<p><img src="09-simple_regression_files/figure-html/unnamed-chunk-11-26.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="code-in-r-2" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Code in R</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1">x =<span class="st"> </span>x<span class="op">$</span><span class="kw">type</span>(torch<span class="op">$</span>FloatTensor)   <span class="co"># make it a a FloatTensor</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2">y =<span class="st"> </span>y<span class="op">$</span><span class="kw">type</span>(torch<span class="op">$</span>FloatTensor)</a>
<a class="sourceLine" id="cb129-3" data-line-number="3"></a>
<a class="sourceLine" id="cb129-4" data-line-number="4">inputs =<span class="st"> </span><span class="kw">Variable</span>(x)</a>
<a class="sourceLine" id="cb129-5" data-line-number="5">outputs =<span class="st"> </span><span class="kw">Variable</span>(y)</a>
<a class="sourceLine" id="cb129-6" data-line-number="6"><span class="kw">plot</span>(x<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), y<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb129-7" data-line-number="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">250</span>) {</a>
<a class="sourceLine" id="cb129-8" data-line-number="8">   prediction =<span class="st"> </span><span class="kw">net</span>(inputs)</a>
<a class="sourceLine" id="cb129-9" data-line-number="9">   loss =<span class="st"> </span><span class="kw">loss_func</span>(prediction, outputs)</a>
<a class="sourceLine" id="cb129-10" data-line-number="10">   optimizer<span class="op">$</span><span class="kw">zero_grad</span>()</a>
<a class="sourceLine" id="cb129-11" data-line-number="11">   loss<span class="op">$</span><span class="kw">backward</span>()</a>
<a class="sourceLine" id="cb129-12" data-line-number="12">   optimizer<span class="op">$</span><span class="kw">step</span>()</a>
<a class="sourceLine" id="cb129-13" data-line-number="13"></a>
<a class="sourceLine" id="cb129-14" data-line-number="14">   <span class="cf">if</span> (i <span class="op">%%</span><span class="st"> </span><span class="dv">10</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb129-15" data-line-number="15">       <span class="co"># plot and show learning process</span></a>
<a class="sourceLine" id="cb129-16" data-line-number="16">      <span class="co"># points(x$data$numpy(), y$data$numpy())</span></a>
<a class="sourceLine" id="cb129-17" data-line-number="17">      <span class="kw">points</span>(x<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), prediction<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb129-18" data-line-number="18">       <span class="co"># cat(i, loss$data$numpy(), &quot;\n&quot;)</span></a>
<a class="sourceLine" id="cb129-19" data-line-number="19">   }</a>
<a class="sourceLine" id="cb129-20" data-line-number="20">}</a></code></pre></div>
<p><img src="09-simple_regression_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="result-1" class="section level2">
<h2><span class="header-section-number">10.5</span> Result</h2>
<p>As you can see below, you successfully performed regression with a neural network. Actually, on every iteration, the red line in the plot will update and change its position to fit the data. But in this picture, you only show you the final result</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datasets-in-pytorch.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bookdown-tips.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["rtorch-book.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
