<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Simple Regression with PyTorch | One at a time</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Simple Regression with PyTorch | One at a time" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Simple Regression with PyTorch | One at a time" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Yihui Xie" />


<meta name="date" content="2019-09-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-data-table.html"/>
<link rel="next" href="autograd.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">One at a time</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="part"><span><b>I Image Recognition</b></span></li>
<li class="part"><span><b>II PyTorch and R data structures</b></span></li>
<li class="chapter" data-level="1" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html"><i class="fa fa-check"></i><b>1</b> Working with data.frame</a><ul>
<li class="chapter" data-level="1.1" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#load-pytorch-libraries"><i class="fa fa-check"></i><b>1.1</b> Load PyTorch libraries</a></li>
<li class="chapter" data-level="1.2" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#dataset-iteration-batch-settings"><i class="fa fa-check"></i><b>1.2</b> Dataset iteration batch settings</a></li>
<li class="chapter" data-level="1.3" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#summary-statistics-for-tensors"><i class="fa fa-check"></i><b>1.3</b> Summary statistics for tensors</a></li>
<li class="chapter" data-level="1.4" data-path="working-with-data-frame.html"><a href="working-with-data-frame.html#using-data.frame"><i class="fa fa-check"></i><b>1.4</b> using <code>data.frame</code></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="working-with-data-table.html"><a href="working-with-data-table.html"><i class="fa fa-check"></i><b>2</b> Working with data.table</a><ul>
<li class="chapter" data-level="2.1" data-path="working-with-data-table.html"><a href="working-with-data-table.html#load-pytorch-libraries-1"><i class="fa fa-check"></i><b>2.1</b> Load PyTorch libraries</a><ul>
<li class="chapter" data-level="2.1.1" data-path="working-with-data-table.html"><a href="working-with-data-table.html#using-data.table"><i class="fa fa-check"></i><b>2.1.1</b> Using `data.table</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III PyTorch with Rmarkdown</b></span></li>
<li class="chapter" data-level="3" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html"><i class="fa fa-check"></i><b>3</b> Simple Regression with PyTorch</a><ul>
<li class="chapter" data-level="3.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#creating-the-network-model"><i class="fa fa-check"></i><b>3.1</b> Creating the network model</a><ul>
<li class="chapter" data-level="3.1.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r"><i class="fa fa-check"></i><b>3.1.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#datasets"><i class="fa fa-check"></i><b>3.2</b> Datasets</a><ul>
<li class="chapter" data-level="3.2.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-1"><i class="fa fa-check"></i><b>3.2.1</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#optimizer-and-loss"><i class="fa fa-check"></i><b>3.3</b> Optimizer and Loss</a><ul>
<li class="chapter" data-level="3.3.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#equivalent-code-in-r"><i class="fa fa-check"></i><b>3.3.1</b> Equivalent code in R</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#training"><i class="fa fa-check"></i><b>3.4</b> Training</a><ul>
<li class="chapter" data-level="3.4.1" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-python"><i class="fa fa-check"></i><b>3.4.1</b> Code in Python</a></li>
<li class="chapter" data-level="3.4.2" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#code-in-r-2"><i class="fa fa-check"></i><b>3.4.2</b> Code in R</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="simple-regression-with-pytorch.html"><a href="simple-regression-with-pytorch.html#result"><i class="fa fa-check"></i><b>3.5</b> Result</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="autograd.html"><a href="autograd.html"><i class="fa fa-check"></i><b>4</b> Autograd</a><ul>
<li class="chapter" data-level="4.1" data-path="autograd.html"><a href="autograd.html#python-code"><i class="fa fa-check"></i><b>4.1</b> Python code</a></li>
<li class="chapter" data-level="4.2" data-path="autograd.html"><a href="autograd.html#r-code"><i class="fa fa-check"></i><b>4.2</b> R code</a></li>
<li class="chapter" data-level="4.3" data-path="autograd.html"><a href="autograd.html#observations"><i class="fa fa-check"></i><b>4.3</b> Observations</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">One at a time</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simple-regression-with-pytorch" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Simple Regression with PyTorch</h1>
<p>This examples combine Python and R code together.</p>
<p>Source: <a href="https://www.guru99.com/pytorch-tutorial.html" class="uri">https://www.guru99.com/pytorch-tutorial.html</a></p>
<div id="creating-the-network-model" class="section level2">
<h2><span class="header-section-number">3.1</span> Creating the network model</h2>
<p>Our network model is a simple Linear layer with an input and an output shape of 1.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">library</span>(rTorch)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="im">from</span> __future__ <span class="im">import</span> print_function</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="im">import</span> torch</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="im">import</span> torch.nn <span class="im">as</span> nn</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="im">import</span> torch.nn.functional <span class="im">as</span> F</a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="im">from</span> torch.autograd <span class="im">import</span> Variable</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"></a>
<a class="sourceLine" id="cb9-8" data-line-number="8">torch.manual_seed(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; &lt;torch._C.Generator object at 0x7f59ffafca90&gt;</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="kw">class</span> Net(nn.Module):</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">   <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">       <span class="bu">super</span>(Net, <span class="va">self</span>).<span class="fu">__init__</span>()</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">       <span class="va">self</span>.layer <span class="op">=</span> torch.nn.Linear(<span class="dv">1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">   <span class="kw">def</span> forward(<span class="va">self</span>, x):</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">       x <span class="op">=</span> <span class="va">self</span>.layer(x)      </a>
<a class="sourceLine" id="cb9-17" data-line-number="17">       <span class="cf">return</span> x</a>
<a class="sourceLine" id="cb9-18" data-line-number="18"></a>
<a class="sourceLine" id="cb9-19" data-line-number="19">net <span class="op">=</span> Net()</a>
<a class="sourceLine" id="cb9-20" data-line-number="20"><span class="bu">print</span>(net)</a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="co">#&gt; Net(</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">#&gt;   (layer): Linear(in_features=1, out_features=1, bias=True)</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">#&gt; )</span></a></code></pre></div>
<p>And the network output should be like this</p>
<pre><code>Net(
  (hidden): Linear(in_features=1, out_features=1, bias=True)
)</code></pre>
<div id="code-in-r" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Code in R</h3>
<p>This would be the equivalent code in R:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(reticulate)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt; Attaching package: &#39;reticulate&#39;</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt; The following objects are masked from &#39;package:rTorch&#39;:</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt;     conda_install, conda_python</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">torch &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch&quot;</span>)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">nn    &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch.nn&quot;</span>)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">Variable &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;torch.autograd&quot;</span>)<span class="op">$</span>Variable</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12">torch<span class="op">$</span><span class="kw">manual_seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="co">#&gt; &lt;torch._C.Generator&gt;</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">main =<span class="st"> </span><span class="kw">py_run_string</span>(</a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="st">&quot;</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"><span class="st">import torch.nn as nn</span></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="st">class Net(nn.Module):</span></a>
<a class="sourceLine" id="cb11-20" data-line-number="20"><span class="st">   def __init__(self):</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="st">       super(Net, self).__init__()</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="st">       self.layer = torch.nn.Linear(1, 1)</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="st">   def forward(self, x):</span></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="st">       x = self.layer(x)      </span></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="st">       return x</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb11-28" data-line-number="28"></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="co"># build a Linear Rgression model</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31">net &lt;-<span class="st"> </span>main<span class="op">$</span><span class="kw">Net</span>()</a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="kw">print</span>(net)</a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="co">#&gt; Net(</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="co">#&gt;   (layer): Linear(in_features=1, out_features=1, bias=True)</span></a>
<a class="sourceLine" id="cb11-35" data-line-number="35"><span class="co">#&gt; )</span></a></code></pre></div>
</div>
</div>
<div id="datasets" class="section level2">
<h2><span class="header-section-number">3.2</span> Datasets</h2>
<p>Before you start the training process, you need to know our data. You make a random function to test our model. <span class="math inline">\(Y = x3 sin(x)+ 3x+0.8 rand(100)\)</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="co"># Visualize our data</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">np.random.seed(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">x <span class="op">=</span> np.random.rand(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb12-8" data-line-number="8">y <span class="op">=</span> np.sin(x) <span class="op">*</span> np.power(x,<span class="dv">3</span>) <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x <span class="op">+</span> np.random.rand(<span class="dv">100</span>)<span class="op">*</span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"></a>
<a class="sourceLine" id="cb12-10" data-line-number="10">plt.scatter(x, y)</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">plt.show()</a></code></pre></div>
<p><img src="0801-simple_regression_files/figure-html/py-datasets-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This is the code in R:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">np    &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;numpy&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">np<span class="op">$</span>random<span class="op">$</span><span class="kw">seed</span>(123L)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">x =<span class="st"> </span>np<span class="op">$</span>random<span class="op">$</span><span class="kw">rand</span>(100L)</a>
<a class="sourceLine" id="cb13-6" data-line-number="6">y =<span class="st"> </span>np<span class="op">$</span><span class="kw">sin</span>(x) <span class="op">*</span><span class="st"> </span>np<span class="op">$</span><span class="kw">power</span>(x, 3L) <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span><span class="st"> </span>np<span class="op">$</span>random<span class="op">$</span><span class="kw">rand</span>(100L)<span class="op">*</span><span class="fl">0.8</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw">plot</span>(x, y)</a></code></pre></div>
<p><img src="0801-simple_regression_files/figure-html/r-datasets-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Before you start the training process, you need to convert the numpy array to Variables that supported by Torch and autograd.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># convert numpy array to tensor in shape of input size</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2">x <span class="op">=</span> torch.from_numpy(x.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)).<span class="bu">float</span>()</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">y <span class="op">=</span> torch.from_numpy(y.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)).<span class="bu">float</span>()</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="bu">print</span>(x, y)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; tensor([[0.6965],</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt;         [0.2861],</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt;         [0.2269],</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt;         [0.5513],</span></a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt;         [0.7195],</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt;         [0.4231],</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt;         [0.9808],</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt;         [0.6848],</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt;         [0.4809],</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt;         [0.3921],</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt;         [0.3432],</span></a>
<a class="sourceLine" id="cb14-16" data-line-number="16"><span class="co">#&gt;         [0.7290],</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17"><span class="co">#&gt;         [0.4386],</span></a>
<a class="sourceLine" id="cb14-18" data-line-number="18"><span class="co">#&gt;         [0.0597],</span></a>
<a class="sourceLine" id="cb14-19" data-line-number="19"><span class="co">#&gt;         [0.3980],</span></a>
<a class="sourceLine" id="cb14-20" data-line-number="20"><span class="co">#&gt;         [0.7380],</span></a>
<a class="sourceLine" id="cb14-21" data-line-number="21"><span class="co">#&gt;         [0.1825],</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22"><span class="co">#&gt;         [0.1755],</span></a>
<a class="sourceLine" id="cb14-23" data-line-number="23"><span class="co">#&gt;         [0.5316],</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"><span class="co">#&gt;         [0.5318],</span></a>
<a class="sourceLine" id="cb14-25" data-line-number="25"><span class="co">#&gt;         [0.6344],</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26"><span class="co">#&gt;         [0.8494],</span></a>
<a class="sourceLine" id="cb14-27" data-line-number="27"><span class="co">#&gt;         [0.7245],</span></a>
<a class="sourceLine" id="cb14-28" data-line-number="28"><span class="co">#&gt;         [0.6110],</span></a>
<a class="sourceLine" id="cb14-29" data-line-number="29"><span class="co">#&gt;         [0.7224],</span></a>
<a class="sourceLine" id="cb14-30" data-line-number="30"><span class="co">#&gt;         [0.3230],</span></a>
<a class="sourceLine" id="cb14-31" data-line-number="31"><span class="co">#&gt;         [0.3618],</span></a>
<a class="sourceLine" id="cb14-32" data-line-number="32"><span class="co">#&gt;         [0.2283],</span></a>
<a class="sourceLine" id="cb14-33" data-line-number="33"><span class="co">#&gt;         [0.2937],</span></a>
<a class="sourceLine" id="cb14-34" data-line-number="34"><span class="co">#&gt;         [0.6310],</span></a>
<a class="sourceLine" id="cb14-35" data-line-number="35"><span class="co">#&gt;         [0.0921],</span></a>
<a class="sourceLine" id="cb14-36" data-line-number="36"><span class="co">#&gt;         [0.4337],</span></a>
<a class="sourceLine" id="cb14-37" data-line-number="37"><span class="co">#&gt;         [0.4309],</span></a>
<a class="sourceLine" id="cb14-38" data-line-number="38"><span class="co">#&gt;         [0.4937],</span></a>
<a class="sourceLine" id="cb14-39" data-line-number="39"><span class="co">#&gt;         [0.4258],</span></a>
<a class="sourceLine" id="cb14-40" data-line-number="40"><span class="co">#&gt;         [0.3123],</span></a>
<a class="sourceLine" id="cb14-41" data-line-number="41"><span class="co">#&gt;         [0.4264],</span></a>
<a class="sourceLine" id="cb14-42" data-line-number="42"><span class="co">#&gt;         [0.8934],</span></a>
<a class="sourceLine" id="cb14-43" data-line-number="43"><span class="co">#&gt;         [0.9442],</span></a>
<a class="sourceLine" id="cb14-44" data-line-number="44"><span class="co">#&gt;         [0.5018],</span></a>
<a class="sourceLine" id="cb14-45" data-line-number="45"><span class="co">#&gt;         [0.6240],</span></a>
<a class="sourceLine" id="cb14-46" data-line-number="46"><span class="co">#&gt;         [0.1156],</span></a>
<a class="sourceLine" id="cb14-47" data-line-number="47"><span class="co">#&gt;         [0.3173],</span></a>
<a class="sourceLine" id="cb14-48" data-line-number="48"><span class="co">#&gt;         [0.4148],</span></a>
<a class="sourceLine" id="cb14-49" data-line-number="49"><span class="co">#&gt;         [0.8663],</span></a>
<a class="sourceLine" id="cb14-50" data-line-number="50"><span class="co">#&gt;         [0.2505],</span></a>
<a class="sourceLine" id="cb14-51" data-line-number="51"><span class="co">#&gt;         [0.4830],</span></a>
<a class="sourceLine" id="cb14-52" data-line-number="52"><span class="co">#&gt;         [0.9856],</span></a>
<a class="sourceLine" id="cb14-53" data-line-number="53"><span class="co">#&gt;         [0.5195],</span></a>
<a class="sourceLine" id="cb14-54" data-line-number="54"><span class="co">#&gt;         [0.6129],</span></a>
<a class="sourceLine" id="cb14-55" data-line-number="55"><span class="co">#&gt;         [0.1206],</span></a>
<a class="sourceLine" id="cb14-56" data-line-number="56"><span class="co">#&gt;         [0.8263],</span></a>
<a class="sourceLine" id="cb14-57" data-line-number="57"><span class="co">#&gt;         [0.6031],</span></a>
<a class="sourceLine" id="cb14-58" data-line-number="58"><span class="co">#&gt;         [0.5451],</span></a>
<a class="sourceLine" id="cb14-59" data-line-number="59"><span class="co">#&gt;         [0.3428],</span></a>
<a class="sourceLine" id="cb14-60" data-line-number="60"><span class="co">#&gt;         [0.3041],</span></a>
<a class="sourceLine" id="cb14-61" data-line-number="61"><span class="co">#&gt;         [0.4170],</span></a>
<a class="sourceLine" id="cb14-62" data-line-number="62"><span class="co">#&gt;         [0.6813],</span></a>
<a class="sourceLine" id="cb14-63" data-line-number="63"><span class="co">#&gt;         [0.8755],</span></a>
<a class="sourceLine" id="cb14-64" data-line-number="64"><span class="co">#&gt;         [0.5104],</span></a>
<a class="sourceLine" id="cb14-65" data-line-number="65"><span class="co">#&gt;         [0.6693],</span></a>
<a class="sourceLine" id="cb14-66" data-line-number="66"><span class="co">#&gt;         [0.5859],</span></a>
<a class="sourceLine" id="cb14-67" data-line-number="67"><span class="co">#&gt;         [0.6249],</span></a>
<a class="sourceLine" id="cb14-68" data-line-number="68"><span class="co">#&gt;         [0.6747],</span></a>
<a class="sourceLine" id="cb14-69" data-line-number="69"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb14-70" data-line-number="70"><span class="co">#&gt;         [0.0832],</span></a>
<a class="sourceLine" id="cb14-71" data-line-number="71"><span class="co">#&gt;         [0.7637],</span></a>
<a class="sourceLine" id="cb14-72" data-line-number="72"><span class="co">#&gt;         [0.2437],</span></a>
<a class="sourceLine" id="cb14-73" data-line-number="73"><span class="co">#&gt;         [0.1942],</span></a>
<a class="sourceLine" id="cb14-74" data-line-number="74"><span class="co">#&gt;         [0.5725],</span></a>
<a class="sourceLine" id="cb14-75" data-line-number="75"><span class="co">#&gt;         [0.0957],</span></a>
<a class="sourceLine" id="cb14-76" data-line-number="76"><span class="co">#&gt;         [0.8853],</span></a>
<a class="sourceLine" id="cb14-77" data-line-number="77"><span class="co">#&gt;         [0.6272],</span></a>
<a class="sourceLine" id="cb14-78" data-line-number="78"><span class="co">#&gt;         [0.7234],</span></a>
<a class="sourceLine" id="cb14-79" data-line-number="79"><span class="co">#&gt;         [0.0161],</span></a>
<a class="sourceLine" id="cb14-80" data-line-number="80"><span class="co">#&gt;         [0.5944],</span></a>
<a class="sourceLine" id="cb14-81" data-line-number="81"><span class="co">#&gt;         [0.5568],</span></a>
<a class="sourceLine" id="cb14-82" data-line-number="82"><span class="co">#&gt;         [0.1590],</span></a>
<a class="sourceLine" id="cb14-83" data-line-number="83"><span class="co">#&gt;         [0.1531],</span></a>
<a class="sourceLine" id="cb14-84" data-line-number="84"><span class="co">#&gt;         [0.6955],</span></a>
<a class="sourceLine" id="cb14-85" data-line-number="85"><span class="co">#&gt;         [0.3188],</span></a>
<a class="sourceLine" id="cb14-86" data-line-number="86"><span class="co">#&gt;         [0.6920],</span></a>
<a class="sourceLine" id="cb14-87" data-line-number="87"><span class="co">#&gt;         [0.5544],</span></a>
<a class="sourceLine" id="cb14-88" data-line-number="88"><span class="co">#&gt;         [0.3890],</span></a>
<a class="sourceLine" id="cb14-89" data-line-number="89"><span class="co">#&gt;         [0.9251],</span></a>
<a class="sourceLine" id="cb14-90" data-line-number="90"><span class="co">#&gt;         [0.8417],</span></a>
<a class="sourceLine" id="cb14-91" data-line-number="91"><span class="co">#&gt;         [0.3574],</span></a>
<a class="sourceLine" id="cb14-92" data-line-number="92"><span class="co">#&gt;         [0.0436],</span></a>
<a class="sourceLine" id="cb14-93" data-line-number="93"><span class="co">#&gt;         [0.3048],</span></a>
<a class="sourceLine" id="cb14-94" data-line-number="94"><span class="co">#&gt;         [0.3982],</span></a>
<a class="sourceLine" id="cb14-95" data-line-number="95"><span class="co">#&gt;         [0.7050],</span></a>
<a class="sourceLine" id="cb14-96" data-line-number="96"><span class="co">#&gt;         [0.9954],</span></a>
<a class="sourceLine" id="cb14-97" data-line-number="97"><span class="co">#&gt;         [0.3559],</span></a>
<a class="sourceLine" id="cb14-98" data-line-number="98"><span class="co">#&gt;         [0.7625],</span></a>
<a class="sourceLine" id="cb14-99" data-line-number="99"><span class="co">#&gt;         [0.5932],</span></a>
<a class="sourceLine" id="cb14-100" data-line-number="100"><span class="co">#&gt;         [0.6917],</span></a>
<a class="sourceLine" id="cb14-101" data-line-number="101"><span class="co">#&gt;         [0.1511],</span></a>
<a class="sourceLine" id="cb14-102" data-line-number="102"><span class="co">#&gt;         [0.3989],</span></a>
<a class="sourceLine" id="cb14-103" data-line-number="103"><span class="co">#&gt;         [0.2409],</span></a>
<a class="sourceLine" id="cb14-104" data-line-number="104"><span class="co">#&gt;         [0.3435]]) tensor([[2.7166],</span></a>
<a class="sourceLine" id="cb14-105" data-line-number="105"><span class="co">#&gt;         [1.3983],</span></a>
<a class="sourceLine" id="cb14-106" data-line-number="106"><span class="co">#&gt;         [0.7679],</span></a>
<a class="sourceLine" id="cb14-107" data-line-number="107"><span class="co">#&gt;         [1.8464],</span></a>
<a class="sourceLine" id="cb14-108" data-line-number="108"><span class="co">#&gt;         [2.6614],</span></a>
<a class="sourceLine" id="cb14-109" data-line-number="109"><span class="co">#&gt;         [1.8297],</span></a>
<a class="sourceLine" id="cb14-110" data-line-number="110"><span class="co">#&gt;         [4.4034],</span></a>
<a class="sourceLine" id="cb14-111" data-line-number="111"><span class="co">#&gt;         [2.7003],</span></a>
<a class="sourceLine" id="cb14-112" data-line-number="112"><span class="co">#&gt;         [2.1778],</span></a>
<a class="sourceLine" id="cb14-113" data-line-number="113"><span class="co">#&gt;         [1.5073],</span></a>
<a class="sourceLine" id="cb14-114" data-line-number="114"><span class="co">#&gt;         [1.2966],</span></a>
<a class="sourceLine" id="cb14-115" data-line-number="115"><span class="co">#&gt;         [2.7287],</span></a>
<a class="sourceLine" id="cb14-116" data-line-number="116"><span class="co">#&gt;         [1.4884],</span></a>
<a class="sourceLine" id="cb14-117" data-line-number="117"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb14-118" data-line-number="118"><span class="co">#&gt;         [1.4895],</span></a>
<a class="sourceLine" id="cb14-119" data-line-number="119"><span class="co">#&gt;         [2.9263],</span></a>
<a class="sourceLine" id="cb14-120" data-line-number="120"><span class="co">#&gt;         [1.0114],</span></a>
<a class="sourceLine" id="cb14-121" data-line-number="121"><span class="co">#&gt;         [0.9445],</span></a>
<a class="sourceLine" id="cb14-122" data-line-number="122"><span class="co">#&gt;         [1.6729],</span></a>
<a class="sourceLine" id="cb14-123" data-line-number="123"><span class="co">#&gt;         [2.4624],</span></a>
<a class="sourceLine" id="cb14-124" data-line-number="124"><span class="co">#&gt;         [2.7788],</span></a>
<a class="sourceLine" id="cb14-125" data-line-number="125"><span class="co">#&gt;         [3.1746],</span></a>
<a class="sourceLine" id="cb14-126" data-line-number="126"><span class="co">#&gt;         [2.6593],</span></a>
<a class="sourceLine" id="cb14-127" data-line-number="127"><span class="co">#&gt;         [2.3800],</span></a>
<a class="sourceLine" id="cb14-128" data-line-number="128"><span class="co">#&gt;         [3.1382],</span></a>
<a class="sourceLine" id="cb14-129" data-line-number="129"><span class="co">#&gt;         [1.7665],</span></a>
<a class="sourceLine" id="cb14-130" data-line-number="130"><span class="co">#&gt;         [1.3082],</span></a>
<a class="sourceLine" id="cb14-131" data-line-number="131"><span class="co">#&gt;         [1.1390],</span></a>
<a class="sourceLine" id="cb14-132" data-line-number="132"><span class="co">#&gt;         [1.5341],</span></a>
<a class="sourceLine" id="cb14-133" data-line-number="133"><span class="co">#&gt;         [2.3566],</span></a>
<a class="sourceLine" id="cb14-134" data-line-number="134"><span class="co">#&gt;         [0.8612],</span></a>
<a class="sourceLine" id="cb14-135" data-line-number="135"><span class="co">#&gt;         [1.4642],</span></a>
<a class="sourceLine" id="cb14-136" data-line-number="136"><span class="co">#&gt;         [1.8066],</span></a>
<a class="sourceLine" id="cb14-137" data-line-number="137"><span class="co">#&gt;         [2.2308],</span></a>
<a class="sourceLine" id="cb14-138" data-line-number="138"><span class="co">#&gt;         [2.0962],</span></a>
<a class="sourceLine" id="cb14-139" data-line-number="139"><span class="co">#&gt;         [1.0096],</span></a>
<a class="sourceLine" id="cb14-140" data-line-number="140"><span class="co">#&gt;         [1.6538],</span></a>
<a class="sourceLine" id="cb14-141" data-line-number="141"><span class="co">#&gt;         [3.3994],</span></a>
<a class="sourceLine" id="cb14-142" data-line-number="142"><span class="co">#&gt;         [3.8747],</span></a>
<a class="sourceLine" id="cb14-143" data-line-number="143"><span class="co">#&gt;         [2.0045],</span></a>
<a class="sourceLine" id="cb14-144" data-line-number="144"><span class="co">#&gt;         [2.0884],</span></a>
<a class="sourceLine" id="cb14-145" data-line-number="145"><span class="co">#&gt;         [0.5845],</span></a>
<a class="sourceLine" id="cb14-146" data-line-number="146"><span class="co">#&gt;         [1.7039],</span></a>
<a class="sourceLine" id="cb14-147" data-line-number="147"><span class="co">#&gt;         [1.7285],</span></a>
<a class="sourceLine" id="cb14-148" data-line-number="148"><span class="co">#&gt;         [3.4602],</span></a>
<a class="sourceLine" id="cb14-149" data-line-number="149"><span class="co">#&gt;         [1.3581],</span></a>
<a class="sourceLine" id="cb14-150" data-line-number="150"><span class="co">#&gt;         [2.0949],</span></a>
<a class="sourceLine" id="cb14-151" data-line-number="151"><span class="co">#&gt;         [3.7935],</span></a>
<a class="sourceLine" id="cb14-152" data-line-number="152"><span class="co">#&gt;         [2.1950],</span></a>
<a class="sourceLine" id="cb14-153" data-line-number="153"><span class="co">#&gt;         [2.6425],</span></a>
<a class="sourceLine" id="cb14-154" data-line-number="154"><span class="co">#&gt;         [0.4948],</span></a>
<a class="sourceLine" id="cb14-155" data-line-number="155"><span class="co">#&gt;         [3.5188],</span></a>
<a class="sourceLine" id="cb14-156" data-line-number="156"><span class="co">#&gt;         [2.1628],</span></a>
<a class="sourceLine" id="cb14-157" data-line-number="157"><span class="co">#&gt;         [1.9643],</span></a>
<a class="sourceLine" id="cb14-158" data-line-number="158"><span class="co">#&gt;         [1.5740],</span></a>
<a class="sourceLine" id="cb14-159" data-line-number="159"><span class="co">#&gt;         [1.0099],</span></a>
<a class="sourceLine" id="cb14-160" data-line-number="160"><span class="co">#&gt;         [1.8123],</span></a>
<a class="sourceLine" id="cb14-161" data-line-number="161"><span class="co">#&gt;         [2.9534],</span></a>
<a class="sourceLine" id="cb14-162" data-line-number="162"><span class="co">#&gt;         [3.6986],</span></a>
<a class="sourceLine" id="cb14-163" data-line-number="163"><span class="co">#&gt;         [1.9485],</span></a>
<a class="sourceLine" id="cb14-164" data-line-number="164"><span class="co">#&gt;         [2.5445],</span></a>
<a class="sourceLine" id="cb14-165" data-line-number="165"><span class="co">#&gt;         [2.4811],</span></a>
<a class="sourceLine" id="cb14-166" data-line-number="166"><span class="co">#&gt;         [2.4700],</span></a>
<a class="sourceLine" id="cb14-167" data-line-number="167"><span class="co">#&gt;         [2.2838],</span></a>
<a class="sourceLine" id="cb14-168" data-line-number="168"><span class="co">#&gt;         [3.4392],</span></a>
<a class="sourceLine" id="cb14-169" data-line-number="169"><span class="co">#&gt;         [0.9015],</span></a>
<a class="sourceLine" id="cb14-170" data-line-number="170"><span class="co">#&gt;         [2.8687],</span></a>
<a class="sourceLine" id="cb14-171" data-line-number="171"><span class="co">#&gt;         [1.4766],</span></a>
<a class="sourceLine" id="cb14-172" data-line-number="172"><span class="co">#&gt;         [1.1847],</span></a>
<a class="sourceLine" id="cb14-173" data-line-number="173"><span class="co">#&gt;         [2.2782],</span></a>
<a class="sourceLine" id="cb14-174" data-line-number="174"><span class="co">#&gt;         [0.8885],</span></a>
<a class="sourceLine" id="cb14-175" data-line-number="175"><span class="co">#&gt;         [3.2565],</span></a>
<a class="sourceLine" id="cb14-176" data-line-number="176"><span class="co">#&gt;         [2.7141],</span></a>
<a class="sourceLine" id="cb14-177" data-line-number="177"><span class="co">#&gt;         [3.0781],</span></a>
<a class="sourceLine" id="cb14-178" data-line-number="178"><span class="co">#&gt;         [0.7763],</span></a>
<a class="sourceLine" id="cb14-179" data-line-number="179"><span class="co">#&gt;         [2.0038],</span></a>
<a class="sourceLine" id="cb14-180" data-line-number="180"><span class="co">#&gt;         [1.8270],</span></a>
<a class="sourceLine" id="cb14-181" data-line-number="181"><span class="co">#&gt;         [0.5882],</span></a>
<a class="sourceLine" id="cb14-182" data-line-number="182"><span class="co">#&gt;         [0.7793],</span></a>
<a class="sourceLine" id="cb14-183" data-line-number="183"><span class="co">#&gt;         [2.6416],</span></a>
<a class="sourceLine" id="cb14-184" data-line-number="184"><span class="co">#&gt;         [1.4162],</span></a>
<a class="sourceLine" id="cb14-185" data-line-number="185"><span class="co">#&gt;         [2.3851],</span></a>
<a class="sourceLine" id="cb14-186" data-line-number="186"><span class="co">#&gt;         [1.9140],</span></a>
<a class="sourceLine" id="cb14-187" data-line-number="187"><span class="co">#&gt;         [1.8385],</span></a>
<a class="sourceLine" id="cb14-188" data-line-number="188"><span class="co">#&gt;         [3.7822],</span></a>
<a class="sourceLine" id="cb14-189" data-line-number="189"><span class="co">#&gt;         [3.6160],</span></a>
<a class="sourceLine" id="cb14-190" data-line-number="190"><span class="co">#&gt;         [1.0941],</span></a>
<a class="sourceLine" id="cb14-191" data-line-number="191"><span class="co">#&gt;         [0.5721],</span></a>
<a class="sourceLine" id="cb14-192" data-line-number="192"><span class="co">#&gt;         [1.6683],</span></a>
<a class="sourceLine" id="cb14-193" data-line-number="193"><span class="co">#&gt;         [1.6848],</span></a>
<a class="sourceLine" id="cb14-194" data-line-number="194"><span class="co">#&gt;         [2.5068],</span></a>
<a class="sourceLine" id="cb14-195" data-line-number="195"><span class="co">#&gt;         [4.3876],</span></a>
<a class="sourceLine" id="cb14-196" data-line-number="196"><span class="co">#&gt;         [1.3866],</span></a>
<a class="sourceLine" id="cb14-197" data-line-number="197"><span class="co">#&gt;         [3.1286],</span></a>
<a class="sourceLine" id="cb14-198" data-line-number="198"><span class="co">#&gt;         [1.9197],</span></a>
<a class="sourceLine" id="cb14-199" data-line-number="199"><span class="co">#&gt;         [2.7949],</span></a>
<a class="sourceLine" id="cb14-200" data-line-number="200"><span class="co">#&gt;         [0.4797],</span></a>
<a class="sourceLine" id="cb14-201" data-line-number="201"><span class="co">#&gt;         [1.8171],</span></a>
<a class="sourceLine" id="cb14-202" data-line-number="202"><span class="co">#&gt;         [1.1042],</span></a>
<a class="sourceLine" id="cb14-203" data-line-number="203"><span class="co">#&gt;         [1.1414]])</span></a></code></pre></div>
<div id="code-in-r-1" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Code in R</h3>
<p>Notice that before converting to a Torch tensor, we need first to convert the R numeric vector to a <code>numpy</code> array:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># convert numpy array to tensor in shape of input size</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw">r_to_py</span>(x)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">y &lt;-<span class="st"> </span><span class="kw">r_to_py</span>(y)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">x =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(x<span class="op">$</span><span class="kw">reshape</span>(<span class="op">-</span>1L, 1L)) <span class="co">#$float()</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">y =<span class="st"> </span>torch<span class="op">$</span><span class="kw">from_numpy</span>(y<span class="op">$</span><span class="kw">reshape</span>(<span class="op">-</span>1L, 1L)) <span class="co">#$float()</span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="kw">print</span>(x, y)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt; tensor([[0.6965],</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt;         [0.2861],</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co">#&gt;         [0.2269],</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co">#&gt;         [0.5513],</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co">#&gt;         [0.7195],</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co">#&gt;         [0.4231],</span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="co">#&gt;         [0.9808],</span></a>
<a class="sourceLine" id="cb15-14" data-line-number="14"><span class="co">#&gt;         [0.6848],</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="co">#&gt;         [0.4809],</span></a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="co">#&gt;         [0.3921],</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="co">#&gt;         [0.3432],</span></a>
<a class="sourceLine" id="cb15-18" data-line-number="18"><span class="co">#&gt;         [0.7290],</span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="co">#&gt;         [0.4386],</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="co">#&gt;         [0.0597],</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="co">#&gt;         [0.3980],</span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="co">#&gt;         [0.7380],</span></a>
<a class="sourceLine" id="cb15-23" data-line-number="23"><span class="co">#&gt;         [0.1825],</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24"><span class="co">#&gt;         [0.1755],</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25"><span class="co">#&gt;         [0.5316],</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26"><span class="co">#&gt;         [0.5318],</span></a>
<a class="sourceLine" id="cb15-27" data-line-number="27"><span class="co">#&gt;         [0.6344],</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28"><span class="co">#&gt;         [0.8494],</span></a>
<a class="sourceLine" id="cb15-29" data-line-number="29"><span class="co">#&gt;         [0.7245],</span></a>
<a class="sourceLine" id="cb15-30" data-line-number="30"><span class="co">#&gt;         [0.6110],</span></a>
<a class="sourceLine" id="cb15-31" data-line-number="31"><span class="co">#&gt;         [0.7224],</span></a>
<a class="sourceLine" id="cb15-32" data-line-number="32"><span class="co">#&gt;         [0.3230],</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33"><span class="co">#&gt;         [0.3618],</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34"><span class="co">#&gt;         [0.2283],</span></a>
<a class="sourceLine" id="cb15-35" data-line-number="35"><span class="co">#&gt;         [0.2937],</span></a>
<a class="sourceLine" id="cb15-36" data-line-number="36"><span class="co">#&gt;         [0.6310],</span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37"><span class="co">#&gt;         [0.0921],</span></a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="co">#&gt;         [0.4337],</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39"><span class="co">#&gt;         [0.4309],</span></a>
<a class="sourceLine" id="cb15-40" data-line-number="40"><span class="co">#&gt;         [0.4937],</span></a>
<a class="sourceLine" id="cb15-41" data-line-number="41"><span class="co">#&gt;         [0.4258],</span></a>
<a class="sourceLine" id="cb15-42" data-line-number="42"><span class="co">#&gt;         [0.3123],</span></a>
<a class="sourceLine" id="cb15-43" data-line-number="43"><span class="co">#&gt;         [0.4264],</span></a>
<a class="sourceLine" id="cb15-44" data-line-number="44"><span class="co">#&gt;         [0.8934],</span></a>
<a class="sourceLine" id="cb15-45" data-line-number="45"><span class="co">#&gt;         [0.9442],</span></a>
<a class="sourceLine" id="cb15-46" data-line-number="46"><span class="co">#&gt;         [0.5018],</span></a>
<a class="sourceLine" id="cb15-47" data-line-number="47"><span class="co">#&gt;         [0.6240],</span></a>
<a class="sourceLine" id="cb15-48" data-line-number="48"><span class="co">#&gt;         [0.1156],</span></a>
<a class="sourceLine" id="cb15-49" data-line-number="49"><span class="co">#&gt;         [0.3173],</span></a>
<a class="sourceLine" id="cb15-50" data-line-number="50"><span class="co">#&gt;         [0.4148],</span></a>
<a class="sourceLine" id="cb15-51" data-line-number="51"><span class="co">#&gt;         [0.8663],</span></a>
<a class="sourceLine" id="cb15-52" data-line-number="52"><span class="co">#&gt;         [0.2505],</span></a>
<a class="sourceLine" id="cb15-53" data-line-number="53"><span class="co">#&gt;         [0.4830],</span></a>
<a class="sourceLine" id="cb15-54" data-line-number="54"><span class="co">#&gt;         [0.9856],</span></a>
<a class="sourceLine" id="cb15-55" data-line-number="55"><span class="co">#&gt;         [0.5195],</span></a>
<a class="sourceLine" id="cb15-56" data-line-number="56"><span class="co">#&gt;         [0.6129],</span></a>
<a class="sourceLine" id="cb15-57" data-line-number="57"><span class="co">#&gt;         [0.1206],</span></a>
<a class="sourceLine" id="cb15-58" data-line-number="58"><span class="co">#&gt;         [0.8263],</span></a>
<a class="sourceLine" id="cb15-59" data-line-number="59"><span class="co">#&gt;         [0.6031],</span></a>
<a class="sourceLine" id="cb15-60" data-line-number="60"><span class="co">#&gt;         [0.5451],</span></a>
<a class="sourceLine" id="cb15-61" data-line-number="61"><span class="co">#&gt;         [0.3428],</span></a>
<a class="sourceLine" id="cb15-62" data-line-number="62"><span class="co">#&gt;         [0.3041],</span></a>
<a class="sourceLine" id="cb15-63" data-line-number="63"><span class="co">#&gt;         [0.4170],</span></a>
<a class="sourceLine" id="cb15-64" data-line-number="64"><span class="co">#&gt;         [0.6813],</span></a>
<a class="sourceLine" id="cb15-65" data-line-number="65"><span class="co">#&gt;         [0.8755],</span></a>
<a class="sourceLine" id="cb15-66" data-line-number="66"><span class="co">#&gt;         [0.5104],</span></a>
<a class="sourceLine" id="cb15-67" data-line-number="67"><span class="co">#&gt;         [0.6693],</span></a>
<a class="sourceLine" id="cb15-68" data-line-number="68"><span class="co">#&gt;         [0.5859],</span></a>
<a class="sourceLine" id="cb15-69" data-line-number="69"><span class="co">#&gt;         [0.6249],</span></a>
<a class="sourceLine" id="cb15-70" data-line-number="70"><span class="co">#&gt;         [0.6747],</span></a>
<a class="sourceLine" id="cb15-71" data-line-number="71"><span class="co">#&gt;         [0.8423],</span></a>
<a class="sourceLine" id="cb15-72" data-line-number="72"><span class="co">#&gt;         [0.0832],</span></a>
<a class="sourceLine" id="cb15-73" data-line-number="73"><span class="co">#&gt;         [0.7637],</span></a>
<a class="sourceLine" id="cb15-74" data-line-number="74"><span class="co">#&gt;         [0.2437],</span></a>
<a class="sourceLine" id="cb15-75" data-line-number="75"><span class="co">#&gt;         [0.1942],</span></a>
<a class="sourceLine" id="cb15-76" data-line-number="76"><span class="co">#&gt;         [0.5725],</span></a>
<a class="sourceLine" id="cb15-77" data-line-number="77"><span class="co">#&gt;         [0.0957],</span></a>
<a class="sourceLine" id="cb15-78" data-line-number="78"><span class="co">#&gt;         [0.8853],</span></a>
<a class="sourceLine" id="cb15-79" data-line-number="79"><span class="co">#&gt;         [0.6272],</span></a>
<a class="sourceLine" id="cb15-80" data-line-number="80"><span class="co">#&gt;         [0.7234],</span></a>
<a class="sourceLine" id="cb15-81" data-line-number="81"><span class="co">#&gt;         [0.0161],</span></a>
<a class="sourceLine" id="cb15-82" data-line-number="82"><span class="co">#&gt;         [0.5944],</span></a>
<a class="sourceLine" id="cb15-83" data-line-number="83"><span class="co">#&gt;         [0.5568],</span></a>
<a class="sourceLine" id="cb15-84" data-line-number="84"><span class="co">#&gt;         [0.1590],</span></a>
<a class="sourceLine" id="cb15-85" data-line-number="85"><span class="co">#&gt;         [0.1531],</span></a>
<a class="sourceLine" id="cb15-86" data-line-number="86"><span class="co">#&gt;         [0.6955],</span></a>
<a class="sourceLine" id="cb15-87" data-line-number="87"><span class="co">#&gt;         [0.3188],</span></a>
<a class="sourceLine" id="cb15-88" data-line-number="88"><span class="co">#&gt;         [0.6920],</span></a>
<a class="sourceLine" id="cb15-89" data-line-number="89"><span class="co">#&gt;         [0.5544],</span></a>
<a class="sourceLine" id="cb15-90" data-line-number="90"><span class="co">#&gt;         [0.3890],</span></a>
<a class="sourceLine" id="cb15-91" data-line-number="91"><span class="co">#&gt;         [0.9251],</span></a>
<a class="sourceLine" id="cb15-92" data-line-number="92"><span class="co">#&gt;         [0.8417],</span></a>
<a class="sourceLine" id="cb15-93" data-line-number="93"><span class="co">#&gt;         [0.3574],</span></a>
<a class="sourceLine" id="cb15-94" data-line-number="94"><span class="co">#&gt;         [0.0436],</span></a>
<a class="sourceLine" id="cb15-95" data-line-number="95"><span class="co">#&gt;         [0.3048],</span></a>
<a class="sourceLine" id="cb15-96" data-line-number="96"><span class="co">#&gt;         [0.3982],</span></a>
<a class="sourceLine" id="cb15-97" data-line-number="97"><span class="co">#&gt;         [0.7050],</span></a>
<a class="sourceLine" id="cb15-98" data-line-number="98"><span class="co">#&gt;         [0.9954],</span></a>
<a class="sourceLine" id="cb15-99" data-line-number="99"><span class="co">#&gt;         [0.3559],</span></a>
<a class="sourceLine" id="cb15-100" data-line-number="100"><span class="co">#&gt;         [0.7625],</span></a>
<a class="sourceLine" id="cb15-101" data-line-number="101"><span class="co">#&gt;         [0.5932],</span></a>
<a class="sourceLine" id="cb15-102" data-line-number="102"><span class="co">#&gt;         [0.6917],</span></a>
<a class="sourceLine" id="cb15-103" data-line-number="103"><span class="co">#&gt;         [0.1511],</span></a>
<a class="sourceLine" id="cb15-104" data-line-number="104"><span class="co">#&gt;         [0.3989],</span></a>
<a class="sourceLine" id="cb15-105" data-line-number="105"><span class="co">#&gt;         [0.2409],</span></a>
<a class="sourceLine" id="cb15-106" data-line-number="106"><span class="co">#&gt;         [0.3435]], dtype=torch.float64)</span></a></code></pre></div>
</div>
</div>
<div id="optimizer-and-loss" class="section level2">
<h2><span class="header-section-number">3.3</span> Optimizer and Loss</h2>
<p>Next, you should define the Optimizer and the Loss Function for our training process.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># Define Optimizer and Loss Function</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">optimizer <span class="op">=</span> torch.optim.SGD(net.parameters(), lr<span class="op">=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">loss_func <span class="op">=</span> torch.nn.MSELoss()</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="bu">print</span>(optimizer)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt; SGD (</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; Parameter Group 0</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt;     dampening: 0</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt;     lr: 0.2</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt;     momentum: 0</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt;     nesterov: False</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt;     weight_decay: 0</span></a>
<a class="sourceLine" id="cb16-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb16-13" data-line-number="13"><span class="bu">print</span>(loss_func)</a>
<a class="sourceLine" id="cb16-14" data-line-number="14"><span class="co">#&gt; MSELoss()</span></a></code></pre></div>
<div id="equivalent-code-in-r" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Equivalent code in R</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="co"># Define Optimizer and Loss Function</span></a>
<a class="sourceLine" id="cb17-2" data-line-number="2">optimizer &lt;-<span class="st"> </span>torch<span class="op">$</span>optim<span class="op">$</span><span class="kw">SGD</span>(net<span class="op">$</span><span class="kw">parameters</span>(), <span class="dt">lr=</span><span class="fl">0.2</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">loss_func &lt;-<span class="st"> </span>torch<span class="op">$</span>nn<span class="op">$</span><span class="kw">MSELoss</span>()</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="kw">print</span>(optimizer)</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="co">#&gt; SGD (</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="co">#&gt; Parameter Group 0</span></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="co">#&gt;     dampening: 0</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="co">#&gt;     lr: 0.2</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="co">#&gt;     momentum: 0</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="co">#&gt;     nesterov: False</span></a>
<a class="sourceLine" id="cb17-11" data-line-number="11"><span class="co">#&gt;     weight_decay: 0</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="co">#&gt; )</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="kw">print</span>(loss_func)</a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="co">#&gt; MSELoss()</span></a></code></pre></div>
</div>
</div>
<div id="training" class="section level2">
<h2><span class="header-section-number">3.4</span> Training</h2>
<div id="code-in-python" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Code in Python</h3>
<p>Now let’s start our training process. With an epoch of 250, you will iterate our data to find the best value for our hyperparameters.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb18-1" data-line-number="1">inputs <span class="op">=</span> Variable(x)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">outputs <span class="op">=</span> Variable(y)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3"><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">250</span>):</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">   prediction <span class="op">=</span> net(inputs)</a>
<a class="sourceLine" id="cb18-5" data-line-number="5">   loss <span class="op">=</span> loss_func(prediction, outputs) </a>
<a class="sourceLine" id="cb18-6" data-line-number="6">   optimizer.zero_grad()</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">   loss.backward()        </a>
<a class="sourceLine" id="cb18-8" data-line-number="8">   optimizer.step()       </a>
<a class="sourceLine" id="cb18-9" data-line-number="9"></a>
<a class="sourceLine" id="cb18-10" data-line-number="10">   <span class="cf">if</span> i <span class="op">%</span> <span class="dv">10</span> <span class="op">==</span> <span class="dv">0</span>:</a>
<a class="sourceLine" id="cb18-11" data-line-number="11">       <span class="co"># plot and show learning process</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12">       plt.cla()</a>
<a class="sourceLine" id="cb18-13" data-line-number="13">       plt.scatter(x.data.numpy(), y.data.numpy())</a>
<a class="sourceLine" id="cb18-14" data-line-number="14">       plt.plot(x.data.numpy(), prediction.data.numpy(), <span class="st">&#39;r-&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb18-15" data-line-number="15">       plt.text(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="st">&#39;Loss=</span><span class="sc">%.4f</span><span class="st">&#39;</span> <span class="op">%</span> loss.data.numpy(), fontdict<span class="op">=</span>{<span class="st">&#39;size&#39;</span>: <span class="dv">10</span>, <span class="st">&#39;color&#39;</span>:  <span class="st">&#39;red&#39;</span>})</a>
<a class="sourceLine" id="cb18-16" data-line-number="16">       plt.pause(<span class="fl">0.1</span>)</a></code></pre></div>
<p><img src="0801-simple_regression_files/figure-html/py-iterate-1.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-2.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-3.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-4.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-5.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-6.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-7.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-8.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-9.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-10.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-11.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-12.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-13.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-14.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-15.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-16.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-17.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-18.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-19.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-20.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-21.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-22.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-23.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-24.png" width="70%" style="display: block; margin: auto;" /><img src="0801-simple_regression_files/figure-html/py-iterate-25.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb19-1" data-line-number="1">plt.show()</a></code></pre></div>
<p><img src="0801-simple_regression_files/figure-html/py-iterate-26.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="code-in-r-2" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Code in R</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">x =<span class="st"> </span>x<span class="op">$</span><span class="kw">type</span>(torch<span class="op">$</span>FloatTensor)   <span class="co"># make it a a FloatTensor</span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2">y =<span class="st"> </span>y<span class="op">$</span><span class="kw">type</span>(torch<span class="op">$</span>FloatTensor)</a>
<a class="sourceLine" id="cb20-3" data-line-number="3"></a>
<a class="sourceLine" id="cb20-4" data-line-number="4">inputs =<span class="st"> </span><span class="kw">Variable</span>(x)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5">outputs =<span class="st"> </span><span class="kw">Variable</span>(y)</a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="kw">plot</span>(x<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), y<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">250</span>) {</a>
<a class="sourceLine" id="cb20-8" data-line-number="8">   prediction =<span class="st"> </span><span class="kw">net</span>(inputs)</a>
<a class="sourceLine" id="cb20-9" data-line-number="9">   loss =<span class="st"> </span><span class="kw">loss_func</span>(prediction, outputs)</a>
<a class="sourceLine" id="cb20-10" data-line-number="10">   optimizer<span class="op">$</span><span class="kw">zero_grad</span>()</a>
<a class="sourceLine" id="cb20-11" data-line-number="11">   loss<span class="op">$</span><span class="kw">backward</span>()</a>
<a class="sourceLine" id="cb20-12" data-line-number="12">   optimizer<span class="op">$</span><span class="kw">step</span>()</a>
<a class="sourceLine" id="cb20-13" data-line-number="13"></a>
<a class="sourceLine" id="cb20-14" data-line-number="14">   <span class="cf">if</span> (i <span class="op">%%</span><span class="st"> </span><span class="dv">10</span> <span class="op">==</span><span class="st"> </span><span class="dv">0</span>) {</a>
<a class="sourceLine" id="cb20-15" data-line-number="15">       <span class="co"># plot and show learning process</span></a>
<a class="sourceLine" id="cb20-16" data-line-number="16">      <span class="co"># points(x$data$numpy(), y$data$numpy())</span></a>
<a class="sourceLine" id="cb20-17" data-line-number="17">      <span class="kw">points</span>(x<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), prediction<span class="op">$</span>data<span class="op">$</span><span class="kw">numpy</span>(), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb20-18" data-line-number="18">       <span class="co"># cat(i, loss$data$numpy(), &quot;\n&quot;)</span></a>
<a class="sourceLine" id="cb20-19" data-line-number="19">   }</a>
<a class="sourceLine" id="cb20-20" data-line-number="20">}</a></code></pre></div>
<p><img src="0801-simple_regression_files/figure-html/r-iterate-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="result" class="section level2">
<h2><span class="header-section-number">3.5</span> Result</h2>
<p>As you can see below, you successfully performed regression with a neural network. Actually, on every iteration, the red line in the plot will update and change its position to fit the data. But in this picture, you only show you the final result</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-data-table.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="autograd.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["one_at_a_time.pdf", "one_at_a_time.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
